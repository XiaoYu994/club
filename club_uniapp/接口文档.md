# 社团招新小程序接口文档

## 1. 通用规范

### 1.1 基础信息

- **基础URL**: `http://localhost:8080`
- **接口版本**: v1
- **请求格式**: JSON
- **响应格式**: JSON
- **字符编码**: UTF-8

### 1.2 认证方式

采用JWT Token认证：
- 登录后获取Token
- 在请求头中添加 `Authorization: Bearer {token}`

### 1.3 通用响应格式

```json
{
  "code": 200,               // 状态码，200成功，非200失败
  "message": "success",      // 响应消息
  "data": {},                // 响应数据
  "timestamp": 1621234567890 // 时间戳
}
```

### 1.4 通用状态码

| 状态码 | 说明 |
| ----- | ---- |
| 200 | 成功 |
| 400 | 请求参数错误 |
| 401 | 未授权/Token无效 |
| 403 | 权限不足 |
| 404 | 资源不存在 |
| 500 | 服务器内部错误 |

## 2. 认证模块

### 2.1 系统管理员登录

- **URL**: `/api/admin/login`
- **Method**: POST
- **描述**: 系统管理员登录接口
- **请求参数**:

```json
{
  "username": "admin",  // 用户名
  "password": "123456"  // 密码
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "adminInfo": {
      "id": 1,
      "username": "admin",
      "type": 1,
      "permissions": ["sys_manage", "club_create", "admin_assign"]
    }
  },
  "timestamp": 1621234567890
}
```

### 2.2 用户登录

- **URL**: `/api/user/login`
- **Method**: POST
- **描述**: 普通用户登录接口
- **请求参数**:

```json
{
  "account": "student123",  // 账号
  "password": "123456"      // 密码
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "userInfo": {
      "id": 1,
      "username": "张三",
      "account": "student123",
      "studentId": "2021001",
      "college": "计算机学院",
      "major": "软件工程",
      "className": "软件2101班"
    },
    "isClubAdmin": true, 
    "adminClubs": [      
      {
        "clubId": 1,
        "clubName": "计算机协会",
        "adminType": 1
      }
    ]
  },
  "timestamp": 1621234567890
}
```

### 2.3 微信小程序登录

- **URL**: `/api/user/wx-login`
- **Method**: POST
- **描述**: 微信小程序登录接口
- **请求参数**:

```json
{
  "code": "023Dk5000OajLM1PxR300KeYiV2Dk50Q"  // 小程序登录code
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "userInfo": {
      "id": 1,
      "username": "张三",
      "openid": "oWa_K5NV_b8pP7E-UrZikea4f2Jo",
      "studentId": "2021001"
    },
    "needBind": false // 是否需要绑定学生信息
  },
  "timestamp": 1621234567890
}
```

### 2.4 用户注册

- **URL**: `/api/user/register`
- **Method**: POST
- **描述**: 用户注册接口
- **请求参数**:

```json
{
  "username": "张三",
  "account": "student123",
  "password": "123456",
  "studentId": "2021001",
  "college": "计算机学院",
  "major": "软件工程",
  "className": "软件2101班",
  "gender": 1,
  "mobile": "13800138000",
  "email": "student@example.com"
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "注册成功",
  "data": {
    "userId": 1
  },
  "timestamp": 1621234567890
}
```

## 3. 系统管理模块

### 3.1 创建社团

- **URL**: `/api/admin/club/create`
- **Method**: POST
- **权限**: 系统管理员
- **描述**: 创建新社团
- **请求参数**:

```json
{
  "name": "计算机协会",
  "logo": "https://example.com/logo.png",
  "description": "这是一个计算机爱好者的社团",
  "type": 2,  // 0=普通社团 1=院级社团 2=校级社团
  "address": "主教学楼B座309",
  "contact": "admin@club.com",
  "orderNum": 1,
  "forms": [] // 自定义表单配置
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "创建成功",
  "data": {
    "clubId": 1
  },
  "timestamp": 1621234567890
}
```

### 3.2 分配社团管理员

- **URL**: `/api/admin/club/assign-admin`
- **Method**: POST
- **权限**: 系统管理员
- **描述**: 为社团分配管理员
- **请求参数**:

```json
{
  "clubId": 1,
  "userId": 2,
  "adminType": 1,  // 0=普通管理员 1=社团超级管理员
  "permissions": "club_manage,member_manage,recruitment_manage",
  "remark": "社长"
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "分配成功",
  "data": {
    "id": 1
  },
  "timestamp": 1621234567890
}
```

### 3.3 获取社团列表

- **URL**: `/api/admin/club/list`
- **Method**: GET
- **权限**: 系统管理员
- **描述**: 获取所有社团列表
- **请求参数**:

```
?page=1&limit=10&name=计算机&type=2&status=1
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 100,
    "list": [
      {
        "id": 1,
        "name": "计算机协会",
        "logo": "https://example.com/logo.png",
        "type": 2,
        "status": 1,
        "memberCount": 120,
        "createTime": 1621234567890
      }
    ]
  },
  "timestamp": 1621234567890
}
```

## 4. 社团管理模块

### 4.1 获取社团详情

- **URL**: `/api/club/detail/{clubId}`
- **Method**: GET
- **权限**: 社团管理员/普通用户
- **描述**: 获取社团详细信息
- **请求参数**: 路径参数 clubId
- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "name": "计算机协会",
    "logo": "https://example.com/logo.png",
    "description": "这是一个计算机爱好者的社团",
    "type": 2,
    "address": "主教学楼B座309",
    "contact": "admin@club.com",
    "memberCount": 120,
    "joinCount": 50,
    "viewCount": 1000,
    "departments": [
      {
        "id": 1,
        "name": "技术部",
        "memberCount": 30
      }
    ],
    "createTime": 1621234567890
  },
  "timestamp": 1621234567890
}
```

### 4.2 更新社团信息

- **URL**: `/api/club/update`
- **Method**: PUT
- **权限**: 社团管理员
- **描述**: 更新社团信息
- **请求参数**:

```json
{
  "id": 1,
  "name": "计算机爱好者协会",
  "logo": "https://example.com/new-logo.png",
  "description": "更新后的社团简介",
  "address": "主教学楼B座310",
  "contact": "new-admin@club.com"
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "更新成功",
  "data": null,
  "timestamp": 1621234567890
}
```

### 4.3 创建社团部门

- **URL**: `/api/club/department/create`
- **Method**: POST
- **权限**: 社团管理员
- **描述**: 创建社团部门
- **请求参数**:

```json
{
  "clubId": 1,
  "name": "宣传部",
  "description": "负责社团宣传工作",
  "orderNum": 2
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "创建成功",
  "data": {
    "departmentId": 2
  },
  "timestamp": 1621234567890
}
```

## 5. 招新管理模块

### 5.1 招新时间配置

- **URL**: `/api/admin/recruitment/config/create`
- **Method**: POST
- **权限**: 系统管理员
- **描述**: 创建学期招新时间配置
- **请求参数**:

```json
{
  "name": "2023-2024学年第一学期招新",
  "semester": "2023-2024-1",
  "globalStartTime": 1693584000000,  // 2023-09-01 00:00:00
  "globalEndTime": 1698796800000,    // 2023-11-01 00:00:00
  "status": 1,
  "description": "本学期社团招新时间安排",
  "typeConfig": [
    {
      "type": 0,  // 普通社团
      "startTime": 1693584000000,  // 2023-09-01 00:00:00
      "endTime": 1696176000000,    // 2023-10-01 00:00:00
      "name": "普通社团招新时间"
    },
    {
      "type": 1,  // 院级社团
      "startTime": 1696262400000,  // 2023-10-02 00:00:00
      "endTime": 1697472000000,    // 2023-10-16 00:00:00
      "name": "院级社团招新时间"
    },
    {
      "type": 2,  // 校级社团
      "startTime": 1697558400000,  // 2023-10-17 00:00:00
      "endTime": 1698796800000,    // 2023-11-01 00:00:00
      "name": "校级社团招新时间"
    }
  ]
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "创建成功",
  "data": {
    "configId": 1
  },
  "timestamp": 1621234567890
}
```

### 5.2 招新时间配置列表

- **URL**: `/api/admin/recruitment/config/list`
- **Method**: GET
- **权限**: 系统管理员
- **描述**: 获取招新时间配置列表
- **请求参数**:

```
?status=1&page=1&limit=10
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 3,
    "list": [
      {
        "id": 1,
        "name": "2023-2024学年第一学期招新",
        "semester": "2023-2024-1",
        "globalStartTime": 1693584000000,
        "globalEndTime": 1698796800000,
        "status": 1,
        "description": "本学期社团招新时间安排",
        "createTime": 1621234567890
      }
    ]
  },
  "timestamp": 1621234567890
}
```

### 5.3 获取当前可用招新配置

- **URL**: `/api/recruitment/config/current`
- **Method**: GET
- **权限**: 社团管理员
- **描述**: 获取当前可用的招新时间配置，用于社团发布招新时参考
- **请求参数**:

```
?clubId=1
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "config": {
      "id": 1,
      "name": "2023-2024学年第一学期招新",
      "semester": "2023-2024-1",
      "clubTypeAllowTime": {
        "startTime": 1693584000000,  // 根据社团类型返回对应的时间
        "endTime": 1696176000000,
        "name": "普通社团招新时间"
      },
      "globalStartTime": 1693584000000,
      "globalEndTime": 1698796800000,
      "status": 1
    },
    "clubType": 0,  // 当前社团类型
    "canPublish": true,  // 是否可以发布招新
    "currentTime": 1621234567890
  },
  "timestamp": 1621234567890
}
```

### 5.4 发布招新信息

- **URL**: `/api/recruitment/publish`
- **Method**: POST
- **权限**: 社团管理员
- **描述**: 发布社团招新信息
- **请求参数**:

```json
{
  "clubId": 1,
  "configId": 1,  // 招新配置ID
  "title": "2023年秋季招新",
  "description": "欢迎加入我们的社团",
  "startTime": 1693584000000,  // 必须在配置的时间范围内
  "endTime": 1696176000000,    // 必须在配置的时间范围内
  "planCount": 50,
  "needInterview": 1,
  "poster": "https://example.com/poster.jpg",
  "forms": [
    {
      "type": "text",
      "label": "自我介绍",
      "required": true,
      "maxLength": 500
    },
    {
      "type": "radio",
      "label": "是否有编程经验",
      "required": true,
      "options": ["有", "没有"]
    }
  ]
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "招新信息已提交，等待审核",
  "data": {
    "recruitmentId": 1
  },
  "timestamp": 1621234567890
}
```

### 5.5 审核招新信息

- **URL**: `/api/admin/recruitment/review`
- **Method**: POST
- **权限**: 系统管理员
- **描述**: 审核社团提交的招新信息
- **请求参数**:

```json
{
  "recruitmentId": 1,
  "status": 1,  // 0=审核中 1=通过 3=驳回
  "reviewComment": "招新时间已调整为符合规定时间范围"
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "审核成功",
  "data": null,
  "timestamp": 1621234567890
}
```

### 5.6 获取招新列表

- **URL**: `/api/recruitment/list`
- **Method**: GET
- **权限**: 社团管理员/普通用户
- **描述**: 获取招新信息列表
- **请求参数**:

```
?clubId=1&status=1&page=1&limit=10
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 5,
    "list": [
      {
        "id": 1,
        "clubId": 1,
        "clubName": "计算机协会",
        "title": "2023年秋季招新",
        "status": 1,
        "startTime": 1693584000000,
        "endTime": 1696176000000,
        "joinCount": 30,
        "planCount": 50,
        "poster": "https://example.com/poster.jpg"
      }
    ]
  },
  "timestamp": 1621234567890
}
```

### 5.7 提交招新申请

- **URL**: `/api/recruitment/apply`
- **Method**: POST
- **权限**: 普通用户
- **描述**: 用户提交加入社团申请
- **请求参数**:

```json
{
  "recruitmentId": 1,
  "clubId": 1,
  "formData": {
    "自我介绍": "我是一名计算机专业的学生，热爱编程...",
    "是否有编程经验": "有"
  }
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "申请提交成功",
  "data": {
    "applyId": 1
  },
  "timestamp": 1621234567890
}
```

### 5.8 审核招新申请

- **URL**: `/api/recruitment/review-apply`
- **Method**: POST
- **权限**: 社团管理员
- **描述**: 审核用户提交的招新申请
- **请求参数**:

```json
{
  "applyId": 1,
  "status": 1,  // 0=待审核 1=已通过 2=已拒绝 3=已面试 4=已入社
  "feedback": "恭喜你通过了初审，请参加面试",
  "interviewTime": 1622234567890,
  "interviewPlace": "主教学楼B座309"
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "审核成功",
  "data": null,
  "timestamp": 1621234567890
}
```

## 6. 成员管理模块

### 6.1 获取社团成员列表

- **URL**: `/api/club/member/list`
- **Method**: GET
- **权限**: 社团管理员
- **描述**: 获取社团成员列表
- **请求参数**:

```
?clubId=1&type=0&department=技术部&page=1&limit=20
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 120,
    "list": [
      {
        "id": 1,
        "userId": 2,
        "username": "张三",
        "studentId": "2021001",
        "avatar": "https://example.com/avatar.jpg",
        "type": 0,
        "position": "成员",
        "department": "技术部",
        "joinTime": 1621234567890
      }
    ]
  },
  "timestamp": 1621234567890
}
```

### 6.2 更新成员信息

- **URL**: `/api/club/member/update`
- **Method**: PUT
- **权限**: 社团管理员
- **描述**: 更新社团成员信息
- **请求参数**:

```json
{
  "id": 1,
  "type": 1,  // 0=普通成员 1=干部 2=社长 3=指导老师
  "position": "技术部长",
  "department": "技术部"
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "更新成功",
  "data": null,
  "timestamp": 1621234567890
}
```

### 6.3 退出社团申请

- **URL**: `/api/club/quit/apply`
- **Method**: POST
- **权限**: 社团成员
- **描述**: 提交退出社团申请
- **请求参数**:

```json
{
  "clubId": 1,
  "reason": "由于个人原因，申请退出社团"
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "申请提交成功",
  "data": {
    "quitId": 1
  },
  "timestamp": 1621234567890
}
```

### 6.4 处理退社申请

- **URL**: `/api/club/quit/review`
- **Method**: POST
- **权限**: 社团管理员
- **描述**: 处理成员退社申请
- **请求参数**:

```json
{
  "quitId": 1,
  "status": 1,  // 0=待审核 1=已通过 2=已拒绝
  "feedback": "同意你的退社申请，感谢你的付出"
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "处理成功",
  "data": null,
  "timestamp": 1621234567890
}
```

## 7. 消息与通知模块

### 7.1 发布社团通知

- **URL**: `/api/club/notice/publish`
- **Method**: POST
- **权限**: 社团管理员
- **描述**: 发布社团通知
- **请求参数**:

```json
{
  "clubId": 1,
  "title": "关于举办技术分享会的通知",
  "content": "本周六下午2点在主教学楼B座309举办技术分享会...",
  "type": 1  // 0=普通通知 1=重要通知
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "发布成功",
  "data": {
    "noticeId": 1
  },
  "timestamp": 1621234567890
}
```

### 7.2 获取通知列表

- **URL**: `/api/club/notice/list`
- **Method**: GET
- **权限**: 社团管理员/成员
- **描述**: 获取社团通知列表
- **请求参数**:

```
?clubId=1&type=1&page=1&limit=10
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 20,
    "list": [
      {
        "id": 1,
        "clubId": 1,
        "title": "关于举办技术分享会的通知",
        "type": 1,
        "viewCount": 98,
        "createTime": 1621234567890
      }
    ]
  },
  "timestamp": 1621234567890
}
```

### 7.3 发送社团消息

- **URL**: `/api/club/message/send`
- **Method**: POST
- **权限**: 社团管理员/成员
- **描述**: 发送社团内部消息
- **请求参数**:

```json
{
  "clubId": 1,
  "content": "请大家记得参加本周六的活动",
  "type": 0,  // 0=普通消息 1=通知公告 2=活动通知
  "attachments": [
    {
      "name": "活动安排.docx",
      "url": "https://example.com/file.docx"
    }
  ]
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "发送成功",
  "data": {
    "messageId": 1
  },
  "timestamp": 1621234567890
}
```

## 8. 活动管理模块

### 8.1 创建社团活动

- **URL**: `/api/club/activity/create`
- **Method**: POST
- **权限**: 社团管理员
- **描述**: 创建社团活动
- **请求参数**:

```json
{
  "clubId": 1,
  "title": "技术分享会",
  "description": "本次活动邀请了行业专家分享前沿技术...",
  "startTime": 1622234567890,
  "endTime": 1622244567890,
  "address": "主教学楼B座309",
  "poster": "https://example.com/activity-poster.jpg",
  "forms": [] // 活动报名表单
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "创建成功",
  "data": {
    "activityId": 1
  },
  "timestamp": 1621234567890
}
```

### 8.2 获取活动列表

- **URL**: `/api/club/activity/list`
- **Method**: GET
- **权限**: 社团管理员/成员/普通用户
- **描述**: 获取社团活动列表
- **请求参数**:

```
?clubId=1&status=1&page=1&limit=10
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 15,
    "list": [
      {
        "id": 1,
        "clubId": 1,
        "clubName": "计算机协会",
        "title": "技术分享会",
        "status": 1,
        "startTime": 1622234567890,
        "endTime": 1622244567890,
        "address": "主教学楼B座309",
        "joinCount": 45,
        "viewCount": 200,
        "poster": "https://example.com/activity-poster.jpg"
      }
    ]
  },
  "timestamp": 1621234567890
}
```

### 8.3 获取活动详情

- **URL**: `/api/club/activity/detail/{activityId}`
- **Method**: GET
- **权限**: 社团管理员/成员/普通用户
- **描述**: 获取活动详细信息
- **请求参数**: 路径参数 activityId
- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "clubId": 1,
    "clubName": "计算机协会",
    "title": "技术分享会",
    "description": "本次活动邀请了行业专家分享前沿技术...",
    "status": 1,
    "startTime": 1622234567890,
    "endTime": 1622244567890,
    "address": "主教学楼B座309",
    "joinCount": 45,
    "viewCount": 200,
    "poster": "https://example.com/activity-poster.jpg",
    "forms": [
      {
        "type": "text",
        "label": "姓名",
        "required": true,
        "maxLength": 50
      },
      {
        "type": "radio",
        "label": "是否需要纸质资料",
        "required": true,
        "options": ["是", "否"]
      }
    ],
    "memberOnly": false,
    "needApproval": true,
    "createTime": 1621234567890
  },
  "timestamp": 1621234567890
}
```

### 8.4 提交活动报名

- **URL**: `/api/club/activity/apply`
- **Method**: POST
- **权限**: 登录用户
- **描述**: 用户提交活动报名申请
- **请求参数**:

```json
{
  "activityId": 1,
  "formData": {
    "姓名": "张三",
    "是否需要纸质资料": "是",
    "备注": "希望能学习到更多技术知识"
  }
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "报名成功",
  "data": {
    "applyId": 1,
    "status": 0,  // 0=待审核 1=已通过 2=已拒绝
    "needApproval": true  // 是否需要审核
  },
  "timestamp": 1621234567890
}
```

### 8.5 获取活动报名列表

- **URL**: `/api/club/activity/apply-list`
- **Method**: GET
- **权限**: 社团管理员
- **描述**: 获取活动的报名列表
- **请求参数**:

```
?activityId=1&status=0&page=1&limit=20
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 45,
    "list": [
      {
        "id": 1,
        "activityId": 1,
        "userId": 5,
        "username": "张三",
        "avatar": "https://example.com/avatar.jpg",
        "status": 0,
        "isMember": 1,
        "checkInStatus": 0,
        "createTime": 1621234567890
      }
    ]
  },
  "timestamp": 1621234567890
}
```

### 8.6 审核活动报名

- **URL**: `/api/club/activity/review-apply`
- **Method**: POST
- **权限**: 社团管理员
- **描述**: 审核用户提交的活动报名申请
- **请求参数**:

```json
{
  "applyId": 1,
  "status": 1,  // 0=待审核 1=已通过 2=已拒绝
  "feedback": "已通过审核，欢迎参加活动"
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "审核成功",
  "data": null,
  "timestamp": 1621234567890
}
```

### 8.7 活动签到

- **URL**: `/api/club/activity/check-in`
- **Method**: POST
- **权限**: 登录用户
- **描述**: 活动参与者进行签到
- **请求参数**:

```json
{
  "activityId": 1,
  "checkInCode": "ABC123"  // 签到码
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "签到成功",
  "data": {
    "checkInTime": 1622234567890
  },
  "timestamp": 1621234567890
}
```

### 8.8 生成活动签到码

- **URL**: `/api/club/activity/generate-check-in-code`
- **Method**: POST
- **权限**: 社团管理员
- **描述**: 生成活动签到码
- **请求参数**:

```json
{
  "activityId": 1,
  "expireMinutes": 30  // 签到码有效时间(分钟)
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "生成成功",
  "data": {
    "checkInCode": "ABC123",
    "expireTime": 1622236367890,
    "qrCodeUrl": "https://example.com/qrcode.jpg"
  },
  "timestamp": 1621234567890
}
```

### 8.9 获取用户活动报名历史

- **URL**: `/api/club/activity/my-applies`
- **Method**: GET
- **权限**: 登录用户
- **描述**: 获取当前用户的活动报名历史
- **请求参数**:

```
?status=1&page=1&limit=10
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 5,
    "list": [
      {
        "id": 1,
        "activityId": 1,
        "activityTitle": "技术分享会",
        "clubName": "计算机协会",
        "status": 1,
        "checkInStatus": 0,
        "startTime": 1622234567890,
        "endTime": 1622244567890,
        "createTime": 1621234567890
      }
    ]
  },
  "timestamp": 1621234567890
}
```

## 9. 文件上传接口

### 9.1 上传图片

- **URL**: `/api/file/upload/image`
- **Method**: POST
- **Content-Type**: multipart/form-data
- **权限**: 登录用户
- **描述**: 上传图片文件
- **请求参数**:

```
file: [图片文件]
type: avatar/logo/poster  // 上传类型
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "上传成功",
  "data": {
    "url": "https://web-cangqio.oss-cn-hangzhou.aliyuncs.com/dome-images/avatar/123456.jpg",
    "name": "123456.jpg"
  },
  "timestamp": 1621234567890
}
```

### 9.2 上传文件

- **URL**: `/api/file/upload/document`
- **Method**: POST
- **Content-Type**: multipart/form-data
- **权限**: 登录用户
- **描述**: 上传文档文件
- **请求参数**:

```
file: [文档文件]
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "上传成功",
  "data": {
    "url": "https://web-cangqio.oss-cn-hangzhou.aliyuncs.com/dome-images/document/123456.docx",
    "name": "123456.docx"
  },
  "timestamp": 1621234567890
}
```

## 10. 社团内部聊天模块

### 10.1 获取聊天群组列表

- **URL**: `/api/chat/group/list`
- **Method**: GET
- **权限**: 登录用户
- **描述**: 获取用户所属的聊天群组列表
- **请求参数**:

```
?clubId=1  // 可选参数，指定社团ID
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "clubId": 1,
        "clubName": "计算机协会",
        "name": "计算机协会公共群",
        "type": 0,
        "avatar": "https://example.com/group-avatar.jpg",
        "description": "计算机协会全员交流群",
        "memberCount": 120,
        "unreadCount": 5,
        "lastMessage": {
          "content": "大家好，欢迎加入计算机协会",
          "senderName": "张三",
          "sendTime": 1621234567890
        }
      },
      {
        "id": 2,
        "clubId": 1,
        "clubName": "计算机协会",
        "name": "技术部交流群",
        "type": 1,
        "avatar": "https://example.com/dept-avatar.jpg",
        "description": "技术部内部交流",
        "memberCount": 30,
        "unreadCount": 2,
        "lastMessage": {
          "content": "周六有技术分享会",
          "senderName": "李四",
          "sendTime": 1621234567890
        }
      }
    ]
  },
  "timestamp": 1621234567890
}
```

### 10.2 创建群组

- **URL**: `/api/chat/group/create`
- **Method**: POST
- **权限**: 社团管理员
- **描述**: 创建新的聊天群组
- **请求参数**:

```json
{
  "clubId": 1,
  "name": "项目小组讨论群",
  "type": 1,  // 0=公共群 1=部门群 2=管理员群
  "description": "负责项目开发的小组讨论群",
  "avatar": "https://example.com/group-avatar.jpg",
  "initialMembers": [1, 2, 3, 4]  // 初始成员ID列表
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "创建成功",
  "data": {
    "groupId": 3
  },
  "timestamp": 1621234567890
}
```

### 10.3 获取群组成员

- **URL**: `/api/chat/group/members`
- **Method**: GET
- **权限**: 群组成员
- **描述**: 获取群组成员列表
- **请求参数**:

```
?groupId=1
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 30,
    "list": [
      {
        "userId": 1,
        "username": "张三",
        "avatar": "https://example.com/avatar1.jpg",
        "nickname": "技术部张三",
        "role": 2,  // 0=普通成员 1=管理员 2=群主
        "joinTime": 1621234567890
      },
      {
        "userId": 2,
        "username": "李四",
        "avatar": "https://example.com/avatar2.jpg",
        "nickname": null,
        "role": 0,
        "joinTime": 1621234567890
      }
    ]
  },
  "timestamp": 1621234567890
}
```

### 10.4 添加群组成员

- **URL**: `/api/chat/group/add-members`
- **Method**: POST
- **权限**: 群组管理员
- **描述**: 向群组添加新成员
- **请求参数**:

```json
{
  "groupId": 1,
  "userIds": [5, 6, 7]
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "添加成功",
  "data": {
    "successCount": 3
  },
  "timestamp": 1621234567890
}
```

### 10.5 移除群组成员

- **URL**: `/api/chat/group/remove-member`
- **Method**: POST
- **权限**: 群组管理员
- **描述**: 从群组移除成员
- **请求参数**:

```json
{
  "groupId": 1,
  "userId": 5
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "移除成功",
  "data": null,
  "timestamp": 1621234567890
}
```

### 10.6 发送群聊消息

- **URL**: `/api/chat/message/send-group`
- **Method**: POST
- **权限**: 群组成员
- **描述**: 发送群聊消息
- **请求参数**:

```json
{
  "groupId": 1,
  "content": "大家好，这是一条测试消息",
  "contentType": 0,  // 0=文本 1=图片 2=语音 3=文件 4=位置
  "refMessageId": null,  // 引用消息ID，可为null
  "mediaUrl": null,
  "mediaSize": null
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "发送成功",
  "data": {
    "messageId": 1,
    "sendTime": 1621234567890
  },
  "timestamp": 1621234567890
}
```

### 10.7 发送私聊消息

- **URL**: `/api/chat/message/send-private`
- **Method**: POST
- **权限**: 登录用户
- **描述**: 发送私聊消息
- **请求参数**:

```json
{
  "receiverId": 2,
  "content": "你好，这是一条私聊测试消息",
  "contentType": 0,
  "refMessageId": null,
  "mediaUrl": null,
  "mediaSize": null
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "发送成功",
  "data": {
    "messageId": 2,
    "sendTime": 1621234567890
  },
  "timestamp": 1621234567890
}
```

### 10.8 获取群聊消息历史

- **URL**: `/api/chat/message/group-history`
- **Method**: GET
- **权限**: 群组成员
- **描述**: 获取群聊历史消息
- **请求参数**:

```
?groupId=1&beforeId=100&limit=20
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "messages": [
      {
        "id": 99,
        "groupId": 1,
        "senderId": 1,
        "senderName": "张三",
        "senderAvatar": "https://example.com/avatar1.jpg",
        "content": "大家好，这是一条测试消息",
        "contentType": 0,
        "status": 1,
        "refMessage": null,
        "mediaUrl": null,
        "mediaSize": null,
        "readCount": 10,
        "createTime": 1621234567890
      },
      {
        "id": 98,
        "groupId": 1,
        "senderId": 2,
        "senderName": "李四",
        "senderAvatar": "https://example.com/avatar2.jpg",
        "content": "欢迎加入群组",
        "contentType": 0,
        "status": 1,
        "refMessage": null,
        "mediaUrl": null,
        "mediaSize": null,
        "readCount": 15,
        "createTime": 1621234566890
      }
    ],
    "hasMore": true
  },
  "timestamp": 1621234567890
}
```

### 10.9 获取私聊消息历史

- **URL**: `/api/chat/message/private-history`
- **Method**: GET
- **权限**: 登录用户
- **描述**: 获取与特定用户的私聊历史消息
- **请求参数**:

```
?userId=2&beforeId=100&limit=20
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "messages": [
      {
        "id": 99,
        "senderId": 1,
        "receiverId": 2,
        "senderName": "张三",
        "senderAvatar": "https://example.com/avatar1.jpg",
        "content": "你好，这是一条私聊测试消息",
        "contentType": 0,
        "status": 1,
        "refMessage": null,
        "mediaUrl": null,
        "mediaSize": null,
        "isRead": true,
        "createTime": 1621234567890
      },
      {
        "id": 98,
        "senderId": 2,
        "receiverId": 1,
        "senderName": "李四",
        "senderAvatar": "https://example.com/avatar2.jpg",
        "content": "你好，很高兴认识你",
        "contentType": 0,
        "status": 1,
        "refMessage": null,
        "mediaUrl": null,
        "mediaSize": null,
        "isRead": true,
        "createTime": 1621234566890
      }
    ],
    "hasMore": true
  },
  "timestamp": 1621234567890
}
```

### 10.10 标记消息已读

- **URL**: `/api/chat/message/mark-read`
- **Method**: POST
- **权限**: 登录用户
- **描述**: 标记一条或多条消息为已读
- **请求参数**:

```json
{
  "messageIds": [98, 99, 100]
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "标记成功",
  "data": null,
  "timestamp": 1621234567890
}
```

### 10.11 撤回消息

- **URL**: `/api/chat/message/recall`
- **Method**: POST
- **权限**: 消息发送者/群组管理员
- **描述**: 撤回已发送的消息（仅支持2分钟内的消息）
- **请求参数**:

```json
{
  "messageId": 99
}
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "撤回成功",
  "data": null,
  "timestamp": 1621234567890
}
```

### 10.12 获取最近会话列表

- **URL**: `/api/chat/recent-sessions`
- **Method**: GET
- **权限**: 登录用户
- **描述**: 获取用户最近的聊天会话列表
- **请求参数**: 无
- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "sessions": [
      {
        "type": "group",  // group=群聊 private=私聊
        "id": 1,  // 群组ID或用户ID
        "name": "计算机协会公共群",
        "avatar": "https://example.com/group-avatar.jpg",
        "unreadCount": 5,
        "lastMessage": {
          "content": "大家好，欢迎加入计算机协会",
          "contentType": 0,
          "senderName": "张三",
          "sendTime": 1621234567890
        }
      },
      {
        "type": "private",
        "id": 2,  // 对方用户ID
        "name": "李四",
        "avatar": "https://example.com/avatar2.jpg",
        "unreadCount": 1,
        "lastMessage": {
          "content": "你好，很高兴认识你",
          "contentType": 0,
          "senderName": "李四",
          "sendTime": 1621234566890
        }
      }
    ]
  },
  "timestamp": 1621234567890
}
```

### 10.13 WebSocket消息接口

- **URL**: `/ws/chat`
- **Protocol**: WebSocket
- **权限**: 登录用户（需要在连接URL中携带token参数）
- **描述**: 建立WebSocket连接接收实时消息
- **连接方式**:

```
ws://localhost:8080/ws/chat?token=xxxx
```

- **接收消息格式**:

```json
{
  "type": "message",  // 消息类型: message=新消息 recall=撤回消息 read=已读通知
  "data": {
    // 当type=message时
    "id": 100,
    "groupId": 1,    // 群聊消息时有值
    "senderId": 1,
    "senderName": "张三",
    "senderAvatar": "https://example.com/avatar1.jpg",
    "receiverId": 2,  // 私聊消息时有值
    "content": "大家好，这是一条测试消息",
    "contentType": 0,
    "refMessageId": null,
    "mediaUrl": null,
    "mediaSize": null,
    "createTime": 1621234567890
    
    // 当type=recall时
    "messageId": 99
    
    // 当type=read时
    "messageId": 98,
    "readerId": 2,
    "readerName": "李四"
  }
}
```

- **发送消息格式**:

```json
{
  "type": "heartbeat",  // 心跳消息
  "data": {
    "timestamp": 1621234567890
  }
}
```

## 11. 统计分析接口

### 11.1 获取社团概览数据

- **URL**: `/api/club/statistics/overview`
- **Method**: GET
- **权限**: 社团管理员
- **描述**: 获取社团概览统计数据
- **请求参数**:

```
?clubId=1
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "memberCount": 120,
    "newMemberCount": 30,
    "activityCount": 15,
    "viewCount": 1500,
    "departmentStats": [
      {
        "name": "技术部",
        "count": 30
      },
      {
        "name": "宣传部",
        "count": 25
      }
    ],
    "memberTrend": [
      {
        "month": "2023-01",
        "count": 80
      },
      {
        "month": "2023-02",
        "count": 90
      }
    ]
  },
  "timestamp": 1621234567890
}
```

### 11.2 获取招新统计数据

- **URL**: `/api/recruitment/statistics`
- **Method**: GET
- **权限**: 社团管理员
- **描述**: 获取招新相关统计数据
- **请求参数**:

```
?recruitmentId=1
```

- **响应示例**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "totalApply": 150,
    "passCount": 50,
    "rejectCount": 30,
    "interviewCount": 70,
    "statusDistribution": [
      {
        "status": 0,
        "name": "待审核",
        "count": 20
      },
      {
        "status": 1,
        "name": "已通过",
        "count": 50
      }
    ],
    "collegeDistribution": [
      {
        "name": "计算机学院",
        "count": 60
      },
      {
        "name": "电子信息学院",
        "count": 40
      }
    ],
    "dailyApplyTrend": [
      {
        "date": "2023-09-01",
        "count": 30
      },
      {
        "date": "2023-09-02",
        "count": 25
      }
    ]
  },
  "timestamp": 1621234567890
}
```

---

以上接口文档提供了社团招新小程序的主要功能模块，包括认证、系统管理、社团管理、招新管理、成员管理、消息通知、活动管理等。实际开发中可根据需求进行适当调整和扩展。 