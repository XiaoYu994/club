{"version":3,"file":"room.js","sources":["pages/chat/room.vue","../../../../../Software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2hhdC9yb29tLnZ1ZQ"],"sourcesContent":["\t<template>\n\t  <view class=\"chat-room-container pageBg\" :class=\"{'panel-open': showMorePanel}\">\n\t\t<!-- é¡¶éƒ¨å¯¼èˆª -->\n\t\t<!-- #ifndef MP-TOUTIAO -->\n\t\t<custom-nav-bar :title=\"roomInfo.name || 'èŠå¤©å®¤'\" :showBack=\"true\">\n\t\t\t<template v-slot:left>\n\t\t\t\t<view class=\"nav-left-btns\">\n\t\t\t\t\t<view class=\"nav-btn\" @tap=\"toggleMemberDrawer\">\n\t\t\t\t\t\t<uni-icons type=\"contact-filled\" size=\"22\" color=\"#333\" />\n\t\t\t\t\t\t<text class=\"member-count-badge\" v-if=\"roomInfo.memberCount\">{{ roomInfo.memberCount }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"nav-btn\" @tap=\"goToSettings\">\n\t\t\t\t\t\t<uni-icons type=\"gear-filled\" size=\"22\" color=\"#333\" />\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</template>\n\t\t</custom-nav-bar>\n\t\t<!-- #endif -->\n\t\t\n\t\t<!-- æ¶ˆæ¯åˆ—è¡¨ -->\n\t\t<scroll-view \n\t\t  class=\"chat-list\" \n\t\t  scroll-y \n\t\t  @scrolltoupper=\"loadMoreMessages\" \n\t\t  upper-threshold=\"50\" \n\t\t  scroll-with-animation \n\t\t  show-scrollbar=\"false\" \n\t\t  :scroll-into-view=\"scrollIntoViewId\"\n\t\t>\n\t\t  <!-- ä¸Šæ‹‰åŠ è½½æç¤ºåŒº -->\n\t\t  <view class=\"load-more\" v-if=\"loading\">\n\t\t    <view class=\"loading-icon\"></view>\n\t\t    <text>æ­£åœ¨åŠ è½½æ›´å¤š...</text>\n\t\t  </view>\n\t\t  <view class=\"load-more\" v-else-if=\"!hasMore\">\n\t\t    <text>æ²¡æœ‰æ›´å¤šæ¶ˆæ¯äº†</text>\n\t\t  </view>\n\t\t  \n\t\t  <!-- æ¶ˆæ¯å®¹å™¨ -->\n\t\t  <view class=\"messages-container\">\n\t\t    <view v-for=\"(msg, idx) in messages\" :key=\"msg.id\" :id=\"'msg-'+msg.id\" class=\"message-item\">\n\t\t\t<!-- æ—¶é—´åˆ†å‰²çº¿ -->\n\t\t\t<view class=\"time-divider\" v-if=\"shouldShowDivider(idx)\">\n\t\t\t  <text>{{ formatDividerTime(msg.createTime) }}</text>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- æ¶ˆæ¯è¡Œ -->\n\t\t\t<view :class=\"['message-row', msg.senderId === userId ? 'self' : 'other']\">\n\t\t\t  <!-- ä»–äººæ¶ˆæ¯ -->\n\t\t\t  <template v-if=\"msg.senderId !== userId\">\n\t\t\t\t<view class=\"avatar-container\">\n\t\t\t\t  <image class=\"avatar\" :src=\"msg.senderAvatar || '/static/images/avatar-default.png'\" mode=\"aspectFill\" />\n\t\t\t\t</view>\n\t\t\t\t<view class=\"message-content\">\n\t\t\t\t  <view class=\"sender-name\">{{ msg.senderName || 'æœªçŸ¥ç”¨æˆ·' }}</view>\n\t\t\t\t  <view class=\"bubble\">\n\t\t\t\t\t<template v-if=\"msg.contentType === 0\">\n\t\t\t\t\t  <text class=\"text\">{{ msg.content }}</text>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"msg.contentType === 1\">\n\t\t\t\t\t  <image class=\"image\" :src=\"msg.mediaUrl\" @tap=\"previewImage(msg.mediaUrl)\" mode=\"widthFix\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"msg.contentType === 2\">\n\t\t\t\t\t  <view class=\"file-box\" @tap=\"openFile(msg.mediaUrl)\">\n\t\t\t\t\t\t<uni-icons type=\"download\" size=\"30\" color=\"#2979ff\" />\n\t\t\t\t\t\t<text class=\"file-name\">{{ extractFileName(msg.mediaUrl) }}</text>\n\t\t\t\t\t  </view>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"msg.contentType === 3\">\n\t\t\t\t\t  <view class=\"location-box\" @tap=\"openLocation(msg.content)\">\n\t\t\t\t\t\t<uni-icons type=\"location\" size=\"24\" color=\"#ff9800\" />\n\t\t\t\t\t\t<text class=\"location-name\">{{ msg.content ? parseLocation(msg.content).name : 'ä½ç½®ä¿¡æ¯' }}</text>\n\t\t\t\t\t  </view>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"msg.contentType === 4\">\n\t\t\t\t\t  <view class=\"custom-box\">\n\t\t\t\t\t\t<uni-icons type=\"info\" size=\"24\" color=\"#2979ff\" />\n\t\t\t\t\t\t<text class=\"custom-text\">è‡ªå®šä¹‰æ¶ˆæ¯</text>\n\t\t\t\t\t  </view>\n\t\t\t\t\t</template>\n\t\t\t\t  </view>\n\t\t\t\t  <view class=\"time\">{{ formatMessageTime(msg.createTime) }}</view>\n\t\t\t\t</view>\n\t\t\t  </template>\n\t\t\t  \n\t\t\t  <!-- è‡ªå·±çš„æ¶ˆæ¯ -->\n\t\t\t  <template v-else>\n\t\t\t\t<view class=\"message-content self\">\n\t\t\t\t  <view class=\"bubble\">\n\t\t\t\t\t<template v-if=\"msg.contentType === 0\">\n\t\t\t\t\t  <text class=\"text\">{{ msg.content }}</text>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"msg.contentType === 1\">\n\t\t\t\t\t  <image class=\"image\" :src=\"msg.mediaUrl\" @tap=\"previewImage(msg.mediaUrl)\" mode=\"widthFix\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"msg.contentType === 2\">\n\t\t\t\t\t  <view class=\"file-box\" @tap=\"openFile(msg.mediaUrl)\">\n\t\t\t\t\t\t<uni-icons  type=\"download\" size=\"30\" color=\"#2979ff\" />\n\t\t\t\t\t\t<text class=\"file-name\">{{ extractFileName(msg.mediaUrl) }}</text>\n\t\t\t\t\t  </view>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"msg.contentType === 3\">\n\t\t\t\t\t  <view class=\"location-box\" @tap=\"openLocation(msg.content)\">\n\t\t\t\t\t\t<uni-icons type=\"location\" size=\"24\" color=\"#ff9800\" />\n\t\t\t\t\t\t<text class=\"location-name\">{{ msg.content ? parseLocation(msg.content).name : 'ä½ç½®ä¿¡æ¯' }}</text>\n\t\t\t\t\t  </view>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else-if=\"msg.contentType === 4\">\n\t\t\t\t\t  <view class=\"custom-box\">\n\t\t\t\t\t\t<uni-icons type=\"info\" size=\"24\" color=\"#2979ff\" />\n\t\t\t\t\t\t<text class=\"custom-text\">è‡ªå®šä¹‰æ¶ˆæ¯</text>\n\t\t\t\t\t  </view>\n\t\t\t\t\t</template>\n\t\t\t\t  </view>\n\t\t\t\t  <view class=\"time\">{{ formatMessageTime(msg.createTime) }}</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"avatar-container\">\n\t\t\t\t  <image class=\"avatar\" :src=\"userAvatar || '/static/images/avatar-default.png'\" mode=\"aspectFill\" />\n\t\t\t\t</view>\n\t\t\t  </template>\n\t\t\t</view>\n\t\t  </view>\n\t\t  </view>\n\t\t</scroll-view>\n\t\t\n\t\t<!-- åº•éƒ¨è¾“å…¥æ¡† - ä½¿ç”¨å›ºå®šå®šä½ -->\n\t\t<view class=\"input-area\" :class=\"{'with-panel': showMorePanel}\">\n\t\t  <!-- æ‰©å±•åŠŸèƒ½æŒ‰é’® -->\n\t\t  <view class=\"more-btn\" @tap=\"toggleMorePanel\">\n\t\t\t<uni-icons type=\"plusempty\" size=\"28\" color=\"#666\"></uni-icons>\n\t\t  </view>\n\t\t  \n\t\t  <!-- æ–‡æœ¬è¾“å…¥ -->\n\t\t  <view class=\"input-wrapper\">\n\t\t\t<textarea\n\t\t\t  class=\"message-input\"\n\t\t\t  v-model=\"messageText\"\n\t\t\t  auto-height\n\t\t\t  :maxlength=\"500\"\n\t\t\t  :cursor-spacing=\"20\"\n\t\t\t  :show-confirm-bar=\"false\"\n\t\t\t  @input=\"handleInput\"\n\t\t\t  @focus=\"inputFocus\"\n\t\t\t  @blur=\"inputBlur\"\n\t\t\t  placeholder=\"è¯·è¾“å…¥æ¶ˆæ¯...\"\n\t\t\t></textarea>\n\t\t  </view>\n\t\t  \n\t\t  <!-- å‘é€æŒ‰é’® -->\n\t\t  <view class=\"send-btn\" @tap=\"sendMessage\" :class=\"{'active': messageText.trim()}\">\n\t\t\t<uni-icons type=\"paperplane-filled\" size=\"24\" color=\"#fff\"></uni-icons>\n\t\t  </view>\n\t\t</view>\n\t\t\n\t\t<!-- æ‰©å±•åŠŸèƒ½é¢æ¿ -->\n\t\t<view class=\"more-panel\" v-if=\"showMorePanel\">\n\t\t  <view class=\"panel-item\" @tap=\"chooseImage\">\n\t\t\t<view class=\"panel-icon\">\n\t\t\t  <uni-icons type=\"image\" size=\"28\" color=\"#07c160\"></uni-icons>\n\t\t\t</view>\n\t\t\t<text>å›¾ç‰‡</text>\n\t\t  </view>\n\t\t  <view class=\"panel-item\" @tap=\"chooseLocation\">\n\t\t\t<view class=\"panel-icon\">\n\t\t\t  <uni-icons type=\"location\" size=\"28\" color=\"#ff9800\"></uni-icons>\n\t\t\t</view>\n\t\t\t<text>ä½ç½®</text>\n\t\t  </view>\n\t\t  <view class=\"panel-item\" @tap=\"chooseFile\">\n\t\t\t<view class=\"panel-icon\">\n\t\t\t  <uni-icons type=\"folder-add\" size=\"28\" color=\"#2979ff\"></uni-icons>\n\t\t\t  \n\t\t\t</view>\n\t\t\t<text>æ–‡ä»¶</text>\n\t\t  </view>\n\t\t</view>\n\t  </view>\n\n\t  <!-- æˆå‘˜åˆ—è¡¨ä¾§è¾¹æ ï¼ˆæŠ½å±‰ï¼‰ -->\n\t  <view class=\"drawer-mask\" v-if=\"showMemberDrawer\" @tap=\"closeMemberDrawer\" :class=\"{'show': showMemberDrawer}\"></view>\n\t  <view class=\"member-drawer\" :class=\"{'show': showMemberDrawer}\">\n\t\t<!-- ä¾§è¾¹æ å¤´éƒ¨ -->\n\t\t<view class=\"drawer-header\">\n\t\t  <view class=\"drawer-title\">\n\t\t\t<text class=\"title-text\">ç¾¤æˆå‘˜</text>\n\t\t\t<text class=\"title-count\">({{ memberList.length }})</text>\n\t\t  </view>\n\t\t  <view class=\"close-btn\" @tap=\"closeMemberDrawer\">\n\t\t\t<uni-icons type=\"closeempty\" size=\"24\" color=\"#666\" />\n\t\t  </view>\n\t\t</view>\n\n\t\t<!-- æœç´¢æ  -->\n\t\t<view class=\"drawer-search\">\n\t\t  <view class=\"search-input-wrapper\">\n\t\t\t<uni-icons type=\"search\" size=\"18\" color=\"#999\" />\n\t\t\t<input\n\t\t\t  class=\"search-input\"\n\t\t\t  v-model=\"searchKeyword\"\n\t\t\t  placeholder=\"æœç´¢æˆå‘˜æ˜µç§°æˆ–å­¦å·\"\n\t\t\t  @input=\"handleSearchInput\"\n\t\t\t/>\n\t\t\t<view class=\"clear-btn\" v-if=\"searchKeyword\" @tap=\"clearSearch\">\n\t\t\t  <uni-icons type=\"clear\" size=\"16\" color=\"#999\" />\n\t\t\t</view>\n\t\t  </view>\n\t\t</view>\n\n\t\t<!-- æˆå‘˜åˆ—è¡¨ -->\n\t\t<scroll-view class=\"drawer-content\" scroll-y>\n\t\t  <view class=\"member-list\">\n\t\t\t<view\n\t\t\t  v-for=\"member in filteredMembers\"\n\t\t\t  :key=\"member.userId\"\n\t\t\t  class=\"member-item\"\n\t\t\t>\n\t\t\t  <view class=\"avatar-wrapper\">\n\t\t\t\t<image\n\t\t\t\t  class=\"avatar\"\n\t\t\t\t  :src=\"member.avatar || '/static/images/avatar-default.png'\"\n\t\t\t\t  mode=\"aspectFill\"\n\t\t\t\t/>\n\t\t\t\t<view\n\t\t\t\t  class=\"online-dot\"\n\t\t\t\t  :class=\"member.isOnline ? 'online' : 'offline'\"\n\t\t\t\t></view>\n\t\t\t  </view>\n\n\t\t\t  <view class=\"member-info\">\n\t\t\t\t<view class=\"nickname\">\n\t\t\t\t  {{ member.nickname || member.username || 'æœªçŸ¥ç”¨æˆ·' }}\n\t\t\t\t  <text class=\"role-badge\" v-if=\"member.role === 2\">ğŸ–ï¸</text>\n\t\t\t\t  <text class=\"role-badge\" v-else-if=\"member.role === 1\">ğŸ›¡ï¸</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"member-meta\" v-if=\"member.studentId\">\n\t\t\t\t  <text class=\"student-id\">{{ member.studentId }}</text>\n\t\t\t\t</view>\n\t\t\t  </view>\n\n\t\t\t  <view class=\"member-status\">\n\t\t\t\t<text class=\"status-text\" :class=\"member.isOnline ? 'online' : 'offline'\">\n\t\t\t\t  {{ member.isOnline ? 'åœ¨çº¿' : 'ç¦»çº¿' }}\n\t\t\t\t</text>\n\t\t\t  </view>\n\t\t\t</view>\n\n\t\t\t<!-- ç©ºçŠ¶æ€ -->\n\t\t\t<view class=\"empty-state\" v-if=\"filteredMembers.length === 0 && !isLoadingMembers\">\n\t\t\t  <uni-icons type=\"info\" size=\"60\" color=\"#ddd\" />\n\t\t\t  <text class=\"empty-text\">{{ searchKeyword ? 'æœªæ‰¾åˆ°ç›¸å…³æˆå‘˜' : 'æš‚æ— ç¾¤æˆå‘˜' }}</text>\n\t\t\t</view>\n\n\t\t\t<!-- åŠ è½½ä¸­ -->\n\t\t\t<view class=\"loading-state\" v-if=\"isLoadingMembers\">\n\t\t\t  <uni-icons type=\"spinner-cycle\" size=\"30\" color=\"#999\" />\n\t\t\t  <text class=\"loading-text\">åŠ è½½ä¸­...</text>\n\t\t\t</view>\n\t\t  </view>\n\t\t</scroll-view>\n\t  </view>\n\t</template>\n\n\t<script setup>\n\timport { ref, reactive, computed, onMounted, onBeforeUnmount, nextTick } from 'vue';\n\timport { onLoad, onUnload, onBackPress, onHide } from '@dcloudio/uni-app';\n\timport apiModule, { chatAPI } from '@/api/api.js';\n\timport wsClient from '@/utils/websocket.js';\n\timport { getToken, getUser, setUser } from '@/utils/auth.js';\n\timport request from '@/utils/request.js';\n\timport { formatTime, formatDate, formatOnlyTime } from '@/utils/common.js';\n\t\n\t// é˜²æŠ–å‡½æ•°ï¼Œé¿å…é¢‘ç¹æ“ä½œ\n\tconst debounce = (fn, delay) => {\n\t  let timer = null;\n\t  return function(...args) {\n\t    if (timer) clearTimeout(timer);\n\t    timer = setTimeout(() => {\n\t      fn.apply(this, args);\n\t    }, delay);\n\t  };\n\t};\n\t\n\t// é¡µé¢æ ˆè®¡æ•°å™¨ï¼ˆç”¨äºåˆ¤æ–­æ˜¯å¦å®Œå…¨é€€å‡ºèŠå¤©æ¨¡å—ï¼‰\n\tlet chatPageCount = 0;\n\t\n\t// è·å–è·¯ç”±å‚æ•°\n\tconst groupId = ref(null);\n\tconst roomInfo = reactive({\n\t  name: '',\n\t  avatar: '',\n\t  memberCount: 0,\n\t  clubId: null // æ·»åŠ clubIdå­—æ®µ\n\t});\n\t\n\t// ç”¨æˆ·ä¿¡æ¯\n\tconst userInfo = getUser();\n\tconsole.log('å½“å‰ç”¨æˆ·ä¿¡æ¯:', userInfo);\n\t\n\t// ç”¨æˆ·ID\n\tconst userIdValue = ref(null);\n\tif (userInfo && userInfo.id) {\n\t  userIdValue.value = Number(userInfo.id);\n\t  console.log('è½¬æ¢åçš„ç”¨æˆ·ID:', userIdValue.value);\n\t}\n\t\n\tconst userId = computed(() => {\n\t  if (userIdValue.value !== null) {\n\t    return userIdValue.value;\n\t  }\n\t  const currentUser = getUser();\n\t  if (currentUser && currentUser.id) {\n\t    userIdValue.value = Number(currentUser.id);\n\t    console.log('é‡æ–°è·å–ç”¨æˆ·ID:', userIdValue.value);\n\t    return userIdValue.value;\n\t  }\n\t  return null;\n\t});\n\tconst userAvatar = ref(userInfo && userInfo.avatar ? userInfo.avatar : '/static/images/avatar-default.png');\n\tconst userName = ref(userInfo && userInfo.name ? userInfo.name : 'æˆ‘');\n\t\n\t// æ¶ˆæ¯çŠ¶æ€\n\tconst messages = ref([]);\n\tconst messageText = ref('');\n\tconst loading = ref(false);\n\tconst page = ref(1);\n\tconst pageSize = ref(10);\n\tconst hasMore = ref(true);\n\tconst showMorePanel = ref(false);\n\tconst scrollIntoViewId = ref('');\n\n\t// æˆå‘˜åˆ—è¡¨ç›¸å…³çŠ¶æ€\n\tconst showMemberDrawer = ref(false); // ä¾§è¾¹æ æ˜¾ç¤ºçŠ¶æ€\n\tconst memberList = ref([]); // æˆå‘˜åˆ—è¡¨æ•°æ®\n\tconst searchKeyword = ref(''); // æœç´¢å…³é”®è¯\n\tconst isLoadingMembers = ref(false); // åŠ è½½çŠ¶æ€\n\tconst isOwner = ref(false); // å½“å‰ç”¨æˆ·æ˜¯å¦æ˜¯ç¾¤ä¸»\n\tconst onlineUserIds = ref(new Set()); // åœ¨çº¿ç”¨æˆ·IDé›†åˆ\n\n\t// æˆå‘˜æ’åºå’Œè¿‡æ»¤ï¼ˆè®¡ç®—å±æ€§ï¼‰\n\tconst sortedMembers = computed(() => {\n\t  // å¤åˆ¶æ•°ç»„é¿å…ç›´æ¥ä¿®æ”¹åŸæ•°ç»„\n\t  const members = [...memberList.value];\n\n\t  // æ’åºè§„åˆ™ï¼šç¾¤ä¸»(2) > ç®¡ç†å‘˜(1) > æ™®é€šæˆå‘˜(0)ï¼ŒåŒçº§åˆ«åœ¨çº¿>ç¦»çº¿ï¼ŒåŒçŠ¶æ€æŒ‰åŠ å…¥æ—¶é—´\n\t  return members.sort((a, b) => {\n\t\t// 1. æŒ‰è§’è‰²æ’åºï¼ˆç¾¤ä¸» > ç®¡ç†å‘˜ > æˆå‘˜ï¼‰\n\t\tif (a.role !== b.role) {\n\t\t  return (b.role || 0) - (a.role || 0);\n\t\t}\n\n\t\t// 2. æŒ‰åœ¨çº¿çŠ¶æ€æ’åºï¼ˆåœ¨çº¿ > ç¦»çº¿ï¼‰\n\t\tif (a.isOnline !== b.isOnline) {\n\t\t  return b.isOnline ? 1 : -1;\n\t\t}\n\n\t\t// 3. æŒ‰åŠ å…¥æ—¶é—´æ’åºï¼ˆæ—© > æ™šï¼‰\n\t\treturn (a.joinTime || 0) - (b.joinTime || 0);\n\t  });\n\t});\n\n\tconst filteredMembers = computed(() => {\n\t  if (!searchKeyword.value || !searchKeyword.value.trim()) {\n\t\treturn sortedMembers.value;\n\t  }\n\n\t  const keyword = searchKeyword.value.trim().toLowerCase();\n\t  return sortedMembers.value.filter(member => {\n\t\tconst nickname = (member.nickname || member.username || '').toLowerCase();\n\t\tconst studentId = (member.studentId || '').toLowerCase();\n\t\treturn nickname.includes(keyword) || studentId.includes(keyword);\n\t  });\n\t});\n\n\t// åˆå§‹åŒ–ä»åç«¯è·å–ç”¨æˆ·ä¿¡æ¯\n\tasync function initUserInfo() {\n\t  if (!getUser()) {\n\t    try {\n\t      const res = await apiModule.user.getUserInfo();\n\t      if (res.code === 200 && res.data) {\n\t        setUser(res.data);\n\t        userAvatar.value = res.data.avatar || userAvatar.value;\n\t        userName.value = res.data.name || userName.value;\n\t        userIdValue.value = Number(res.data.id);\n\t        console.log('ä»åç«¯æ‹‰å–å¹¶æ›´æ–°ç”¨æˆ·ä¿¡æ¯:', res.data);\n\t      }\n\t    } catch (e) {\n\t      console.error('è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', e);\n\t    }\n\t  }\n\t}\n\t\n\t/**\n\t * @description æ›´æ–°æ¶ˆæ¯å¤„ç†å‡½æ•°ï¼ˆç¾¤ç»„åˆ‡æ¢æ—¶è°ƒç”¨ï¼‰\n\t */\n\tfunction updateMessageHandler() {\n\t  // æ³¨å†ŒèŠå¤©å®¤æ¶ˆæ¯å¤„ç†å™¨ï¼ˆä¸æ¸…é™¤å…¨å±€å¤„ç†å™¨ï¼Œé¿å…å½±å“é€šçŸ¥åŠŸèƒ½ï¼‰\n\t  wsClient.onMessageType('group_message', handleReceivedMessage);\n\t  wsClient.onMessageType('error', handleError);\n\t  console.log('ã€èŠå¤©å®¤ã€‘æ¶ˆæ¯å¤„ç†å™¨å·²æ³¨å†Œ');\n\t}\n\t\n\t/**\n\t * @description ç¡®ä¿WebSocketè¿æ¥ï¼Œä¸ä¼šé‡å¤å»ºç«‹è¿æ¥\n\t */\n\tconst connectWebSocket = async () => {\n\t  // è·å–åç«¯æœåŠ¡å™¨åœ°å€ï¼Œä»api.jsä¸­å¼•å…¥baseURL\n\t  const serverUrl = apiModule.baseURL || 'localhost:8081';\n\n\t  if (wsClient.isConnected) {\n\t    console.log('ã€èŠå¤©å®¤ã€‘WebSocketå·²è¿æ¥ï¼Œç›´æ¥ä½¿ç”¨ç°æœ‰è¿æ¥');\n\t    updateMessageHandler();\n\t    return;\n\t  }\n\n\t  console.log('ã€èŠå¤©å®¤ã€‘WebSocketæœªè¿æ¥ï¼Œå°è¯•è¿æ¥...');\n\t  try {\n\t    // ä¼ å…¥ false è¡¨ç¤ºä¸å¼ºåˆ¶é‡è¿ï¼Œå¦‚æœå·²è¿æ¥åˆ™å¤ç”¨\n\t    await wsClient.connect(serverUrl, false);\n\t    console.log('ã€èŠå¤©å®¤ã€‘WebSocketè¿æ¥æˆåŠŸ');\n\t    updateMessageHandler();\n\t  } catch (error) {\n\t    console.warn('ã€èŠå¤©å®¤ã€‘WebSocketåˆæ¬¡è¿æ¥å¤±è´¥ï¼Œæ­£åœ¨é‡è¯•...', error);\n\t    // ä¸ä¸»åŠ¨æç¤ºç”¨æˆ·ï¼Œç­‰å¾…è‡ªåŠ¨é‡è¿\n\t  }\n\t};\n\t\n\t/**\n\t * @description åŠ è½½ç¾¤ç»„è¯¦æƒ…ä¿¡æ¯\n\t */\n\tconst loadGroupDetail = async () => {\n\t  try {\n\t    const response = await chatAPI.getGroupDetail(groupId.value);\n\t    if (response.code === 200) {\n\t      Object.assign(roomInfo, response.data);\n\t    } else {\n\t      uni.showToast({\n\t        title: response.msg || 'è·å–ç¾¤ç»„ä¿¡æ¯å¤±è´¥',\n\t        icon: 'none'\n\t      });\n\t    }\n\t  } catch (error) {\n\t    console.error('è·å–ç¾¤ç»„è¯¦æƒ…å¤±è´¥:', error);\n\t  }\n\t};\n\t\n\t/**\n\t * @description æ ¼å¼åŒ–æ¶ˆæ¯æ—¶é—´ï¼Œç”¨äºæ˜¾ç¤ºæ—¶é—´åˆ†å‰²çº¿\n\t */\n\tfunction formatDividerTime(timestamp) {\n\t  if (!timestamp) return '';\n\t  \n\t  let dateObj;\n\t  // å¤„ç†æ—¶é—´æˆ³\n\t  if (typeof timestamp === 'number') {\n\t    dateObj = new Date(timestamp);\n\t  } \n\t  // å¤„ç†ISOæ ¼å¼å­—ç¬¦ä¸²\n\t  else if (typeof timestamp === 'string') {\n\t    if (timestamp.includes('T') || timestamp.includes('-')) {\n\t      dateObj = new Date(timestamp);\n\t    } else {\n\t      // å¤„ç†çº¯æ•°å­—å­—ç¬¦ä¸²\n\t      dateObj = new Date(parseInt(timestamp));\n\t    }\n\t  } \n\t  // å¤„ç†Dateå¯¹è±¡\n\t  else if (timestamp instanceof Date) {\n\t    dateObj = timestamp;\n\t  }\n\t  \n\t  // æ£€æŸ¥æ—¥æœŸæ˜¯å¦æœ‰æ•ˆ\n\t  if (isNaN(dateObj.getTime())) {\n\t    console.error('æ— æ•ˆçš„æ—¶é—´æ ¼å¼:', timestamp);\n\t    return 'æœªçŸ¥æ—¶é—´';\n\t  }\n\t  \n\t  const now = new Date();\n\t  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n\t  const yesterday = new Date(today);\n\t  yesterday.setDate(yesterday.getDate() - 1);\n\t  \n\t  const msgDate = new Date(dateObj.getFullYear(), dateObj.getMonth(), dateObj.getDate());\n\t  \n\t  // ä»Šå¤©çš„æ¶ˆæ¯æ˜¾ç¤ºæ—¶é—´\n\t  if (msgDate.getTime() === today.getTime()) {\n\t    return `ä»Šå¤© ${dateObj.getHours().toString().padStart(2, '0')}:${dateObj.getMinutes().toString().padStart(2, '0')}`;\n\t  }\n\t  // æ˜¨å¤©çš„æ¶ˆæ¯\n\t  else if (msgDate.getTime() === yesterday.getTime()) {\n\t    return `æ˜¨å¤© ${dateObj.getHours().toString().padStart(2, '0')}:${dateObj.getMinutes().toString().padStart(2, '0')}`;\n\t  }\n\t  // ä»Šå¹´çš„å…¶ä»–æ—¥æœŸ\n\t  else if (msgDate.getFullYear() === now.getFullYear()) {\n\t    return `${(dateObj.getMonth() + 1).toString().padStart(2, '0')}-${dateObj.getDate().toString().padStart(2, '0')} ${dateObj.getHours().toString().padStart(2, '0')}:${dateObj.getMinutes().toString().padStart(2, '0')}`;\n\t  }\n\t  // å…¶ä»–å¹´ä»½\n\t  else {\n\t    return `${dateObj.getFullYear()}-${(dateObj.getMonth() + 1).toString().padStart(2, '0')}-${dateObj.getDate().toString().padStart(2, '0')} ${dateObj.getHours().toString().padStart(2, '0')}:${dateObj.getMinutes().toString().padStart(2, '0')}`;\n\t  }\n\t}\n\t\n\t/**\n\t * @description æ ¼å¼åŒ–æ¶ˆæ¯æ—¶é—´ï¼Œç”¨äºæ˜¾ç¤ºæ¶ˆæ¯æ—¶é—´\n\t */\n\tfunction formatMessageTime(timestamp) {\n\t  if (!timestamp) return '';\n\t  \n\t  let dateObj;\n\t  // å¤„ç†æ—¶é—´æˆ³\n\t  if (typeof timestamp === 'number') {\n\t    dateObj = new Date(timestamp);\n\t  } \n\t  // å¤„ç†ISOæ ¼å¼å­—ç¬¦ä¸²\n\t  else if (typeof timestamp === 'string') {\n\t    if (timestamp.includes('T') || timestamp.includes('-')) {\n\t      dateObj = new Date(timestamp);\n\t    } else {\n\t      // å¤„ç†çº¯æ•°å­—å­—ç¬¦ä¸²\n\t      dateObj = new Date(parseInt(timestamp));\n\t    }\n\t  } \n\t  // å¤„ç†Dateå¯¹è±¡\n\t  else if (timestamp instanceof Date) {\n\t    dateObj = timestamp;\n\t  }\n\t  \n\t  // æ£€æŸ¥æ—¥æœŸæ˜¯å¦æœ‰æ•ˆ\n\t  if (isNaN(dateObj.getTime())) {\n\t    console.error('æ— æ•ˆçš„æ—¶é—´æ ¼å¼:', timestamp);\n\t    return 'æœªçŸ¥æ—¶é—´';\n\t  }\n\t  \n\t  return `${dateObj.getHours().toString().padStart(2, '0')}:${dateObj.getMinutes().toString().padStart(2, '0')}`;\n\t}\n\t\n\t/**\n\t * @description åˆ¤æ–­æ˜¯å¦éœ€è¦æ˜¾ç¤ºæ—¶é—´åˆ†å‰²çº¿\n\t */\n\tconst shouldShowDivider = (index) => {\n\t  // ä»…åœ¨éé¦–æ¡æ¶ˆæ¯æ˜¾ç¤ºï¼Œå¹¶ä¸”æ ¼å¼åŒ–æ—¶é—´éç©º\n\t  if (index <= 0) return false;\n\t  const dividerTime = formatDividerTime(messages.value[index].createTime);\n\t  if (!dividerTime) return false;\n\t  // æ¯”è¾ƒå½“å‰æ¶ˆæ¯å’Œå‰ä¸€æ¡æ¶ˆæ¯æ—¶é—´å·®\n\t  const currentMsg = messages.value[index];\n\t  const prevMsg = messages.value[index - 1];\n\t  if (!currentMsg || !prevMsg || !currentMsg.createTime || !prevMsg.createTime) return false;\n\t  let currentTime, prevTime;\n\t  try {\n\t    currentTime = typeof currentMsg.createTime === 'number'\n\t      ? currentMsg.createTime\n\t      : new Date(currentMsg.createTime).getTime();\n\t    prevTime = typeof prevMsg.createTime === 'number'\n\t      ? prevMsg.createTime\n\t      : new Date(prevMsg.createTime).getTime();\n\t    return Math.abs(prevTime - currentTime) > 5 * 60 * 1000;\n\t  } catch (e) {\n\t    console.error('æ¯”è¾ƒæ¶ˆæ¯æ—¶é—´å‡ºé”™:', e);\n\t    return false;\n\t  }\n\t};\n\t\n\t/**\n\t * @description åŠ è½½åˆå§‹æ¶ˆæ¯\n\t */\n\tasync function loadInitialMessages() {\n\t  if (loading.value) return;\n\t  \n\t  loading.value = true;\n\t  try {\n\t    const response = await chatAPI.getGroupMessages(groupId.value, 1, pageSize.value);\n\t    if (response.code === 200) {\n\t            // åç«¯è¿”å›çš„æ•°æ®æ˜¯æŒ‰æ—¶é—´é™åºæ’åºçš„ï¼Œéœ€è¦åè½¬ä¸ºå‡åºï¼ˆæœ€è€çš„æ¶ˆæ¯åœ¨å‰ï¼‰\n\t      const pageMsgs = (response.data.list || []);\n\t      \n\t      // é¢„å…ˆå¤„ç†æ¶ˆæ¯æ•°æ®\n\t      const processedMsgs = pageMsgs.map(msg => {\n\t        if (msg.createTime === undefined && msg.create_time) {\n\t          msg.createTime = msg.create_time;\n\t        }\n\t        msg.senderId = Number(msg.senderId);\n\t        if (userId.value) {\n\t          msg.isSelf = msg.senderId === userId.value;\n\t        } else {\n\t          msg.isSelf = false;\n\t        }\n\t        return msg;\n\t      });\n\t      \n      // åè½¬æ¶ˆæ¯é¡ºåºï¼Œä½¿æœ€è€çš„æ¶ˆæ¯åœ¨å‰ï¼Œæœ€æ–°çš„æ¶ˆæ¯åœ¨å\n      messages.value = processedMsgs.reverse();\n\t      nextTick(() => {\n        // æ»šåŠ¨åˆ°æœ€æ–°çš„æ¶ˆæ¯ï¼ˆæ•°ç»„æœ«å°¾ï¼‰\n        const lastMsg = messages.value[messages.value.length - 1];\n        if (lastMsg) {\n          scrollIntoViewId.value = 'msg-' + lastMsg.id;\n        }\n\t      });\n\t      page.value = 2;\n\t      hasMore.value = processedMsgs.length >= pageSize.value;\n\t    } else {\n\t      uni.showToast({ title: response.msg || 'è·å–æ¶ˆæ¯å¤±è´¥', icon: 'none' });\n\t    }\n\t  } catch (error) {\n\t    console.error('è·å–æ¶ˆæ¯å†å²å¤±è´¥:', error);\n\t  } finally {\n\t    loading.value = false;\n\t  }\n\t}\n\t\n\t// èŠ‚æµç‰ˆæœ¬çš„loadMoreMessagesï¼Œé¿å…é¢‘ç¹è§¦å‘\n\tconst loadMoreMessages = debounce(async () => {\n\t  if (loading.value || !hasMore.value) return;\n\t  \n\t  loading.value = true;\n\t  \n\t  try {\n\t    const response = await chatAPI.getGroupMessages(groupId.value, page.value, pageSize.value);\n\t    if (response.code === 200) {\n\t      const pageMsgs = (response.data.list || []);\n\t      // é¢„å…ˆå¤„ç†æ¶ˆæ¯æ•°æ®ï¼Œé¿å…å¾ªç¯å†…å¤šæ¬¡å¤„ç†\n\t      const processedMsgs = pageMsgs.map(msg => {\n\t        if (msg.createTime === undefined && msg.create_time) {\n\t          msg.createTime = msg.create_time;\n\t        }\n\t        msg.senderId = Number(msg.senderId);\n\t        if (userId.value) {\n\t          msg.isSelf = msg.senderId === userId.value;\n\t        } else {\n\t          msg.isSelf = false;\n\t        }\n\t        return msg;\n\t      });\n\t      \n\t      // å†å²æ¶ˆæ¯ï¼ˆæ›´æ—§çš„ï¼‰éœ€è¦åè½¬åæ·»åŠ åˆ°æ•°ç»„å‰é¢\n\t      if (processedMsgs.length > 0) {\n\t        // åè½¬å†å²æ¶ˆæ¯é¡ºåºï¼Œç„¶åæ·»åŠ åˆ°æ•°ç»„å‰é¢\n\t        const reversedMsgs = processedMsgs.reverse();\n\t        messages.value = [...reversedMsgs, ...messages.value];\n\t      }\n\t      page.value++;\n\t      hasMore.value = processedMsgs.length >= pageSize.value;\n\t    } else {\n\t      uni.showToast({ title: response.msg || 'è·å–æ¶ˆæ¯å¤±è´¥', icon: 'none' });\n\t    }\n\t  } catch (error) {\n\t    console.error('è·å–æ¶ˆæ¯å†å²å¤±è´¥:', error);\n\t  } finally {\n\t    loading.value = false;\n\t  }\n\t}, 300);\n\t\n\t/**\n\t * @description å¤„ç†æ¥æ”¶åˆ°çš„WebSocketæ¶ˆæ¯\n\t */\n\tconst handleReceivedMessage = (message) => {\n\t  if (message.groupId === groupId.value) {\n\t    message.senderId = Number(message.senderId);\n\t    \n\t    console.log('æ”¶åˆ°WebSocketæ¶ˆæ¯:', message);\n\t    \n\t    if (message.contentType === 3) {\n\t      try {\n\t        if (typeof message.content === 'string') {\n\t          const locationData = JSON.parse(message.content);\n\t          if (!locationData.name) {\n\t            locationData.name = locationData.address || 'ä½ç½®ä¿¡æ¯';\n\t          }\n\t          message.content = JSON.stringify(locationData);\n\t        }\n\t      } catch (e) {\n\t        console.error('è§£æä½ç½®æ¶ˆæ¯å¤±è´¥:', e);\n\t      }\n\t    }\n\t    \n\t    if (userId.value && message.senderId === userId.value) {\n\t      if (message.localMsgId) {\n\t        const localMsgIndex = messages.value.findIndex(msg => \n\t          msg.isLocalMessage && msg.id === message.localMsgId);\n\t          \n\t        if (localMsgIndex !== -1) {\n\t          messages.value.splice(localMsgIndex, 1, message);\n\t          return;\n\t        }\n\t      }\n\t    }\n\t    \n\t    // æ–°æ¶ˆæ¯æ·»åŠ åˆ°æ•°ç»„æœ«å°¾ï¼ˆä¿æŒæ—¶é—´é¡ºåºï¼‰\n\t    messages.value.push(message);\n\t    nextTick(() => {\n\t      scrollIntoViewId.value = 'msg-' + message.id;\n\t    });\n\t    \n\t  }\n\t};\n\t\n\t/**\n\t * @description å¤„ç†WebSocketé”™è¯¯æ¶ˆæ¯\n\t */\n\tconst handleError = (message) => {\n\t  uni.showToast({\n\t    title: message.content || 'å‘ç”Ÿé”™è¯¯',\n\t    icon: 'none'\n\t  });\n\t};\n\t\n\t/**\n\t * @description å‘é€æ¶ˆæ¯\n\t */\n\tconst sendMessage = () => {\n\t  const content = messageText.value.trim();\n\t  if (!content) return;\n\t\n\t  if (!userId.value) {\n\t    const currentUser = getUser();\n\t    if (currentUser && currentUser.id) {\n\t      userIdValue.value = Number(currentUser.id);\n\t    } else {\n\t      uni.showToast({ title: 'ç”¨æˆ·ä¿¡æ¯è·å–å¤±è´¥', icon: 'none' });\n\t      return;\n\t    }\n\t  }\n\t\n\t  const timestamp = Date.now();\n\t  const avatar = userAvatar.value || '/static/images/avatar-default.png';\n\t  const localMsg = {\n\t    id: `local-${timestamp}`,\n\t    groupId: groupId.value,\n\t    senderId: userId.value,\n\t    senderName: userName.value,\n\t    senderAvatar: avatar,\n\t    createTime: timestamp,\n\t    content: content,\n\t    contentType: 0,\n\t    isLocalMessage: true\n\t  };\n\t  \n\t  // æ·»åŠ åˆ°æ¶ˆæ¯åˆ—è¡¨æœ«å°¾ï¼ˆä¿æŒæ—¶é—´é¡ºåºï¼‰\n\t  messages.value.push(localMsg);\n\t  nextTick(() => {\n\t    scrollIntoViewId.value = 'msg-' + localMsg.id;\n\t  });\n\t\n\t  if (!wsClient.isConnected) {\n\t    uni.showToast({ title: 'èŠå¤©æœåŠ¡æœªè¿æ¥', icon: 'none' });\n\t    return;\n\t  }\n\t\n\t  const message = {\n\t    type: 'group_message',\n\t    groupId: groupId.value,\n\t    content: content,\n\t    contentType: 0,\n\t    localMsgId: localMsg.id\n\t  };\n\t\n\t  wsClient.sendMessage(message);\n\t\n\t  messageText.value = '';\n\t  showMorePanel.value = false;\n\t};\n\t\n\t// è¾“å…¥å¤„ç†\n\tconst handleInput = (e) => {\n\t  messageText.value = e.detail.value;\n\t};\n\t\n\tconst inputFocus = () => {\n\t  showMorePanel.value = false;\n\t};\n\t\n\tconst inputBlur = () => {\n\t  // å¯ä»¥åœ¨è¿™é‡Œå¤„ç†å¤±å»ç„¦ç‚¹çš„é€»è¾‘\n\t};\n\t\n\t// åˆ‡æ¢æ›´å¤šé¢æ¿\n\tconst toggleMorePanel = () => {\n\t  showMorePanel.value = !showMorePanel.value;\n\t};\n\t\n\t/**\n\t * æå–æ–‡ä»¶å\n\t */\n\tconst extractFileName = (url) => {\n\t  if (!url) return 'æœªçŸ¥æ–‡ä»¶';\n\t  const parts = url.split('/');\n\t  return parts[parts.length - 1];\n\t};\n\t\n\t/**\n\t * è§£æä½ç½®ä¿¡æ¯\n\t */\n\tconst parseLocation = (content) => {\n\t  try {\n\t    if (typeof content === 'string') {\n\t      return JSON.parse(content);\n\t    }\n\t    return content;\n\t  } catch (e) {\n\t    console.error('è§£æä½ç½®ä¿¡æ¯å¤±è´¥:', e);\n\t    return { name: 'ä½ç½®ä¿¡æ¯', address: '' };\n\t  }\n\t};\n\t\n\t/**\n\t * é¢„è§ˆå›¾ç‰‡\n\t */\n\tconst previewImage = (url) => {\n\t  if (!url) return;\n\t  uni.previewImage({\n\t    urls: [url],\n\t    current: url\n\t  });\n\t};\n\t\n\t/**\n\t * æ‰“å¼€æ–‡ä»¶\n\t */\n\tconst openFile = (url) => {\n\t  if (!url) {\n\t    uni.showToast({ title: 'æ–‡ä»¶é“¾æ¥æ— æ•ˆ', icon: 'none' });\n\t    return;\n\t  }\n\t  \n\t  uni.showLoading({\n\t    title: 'æ­£åœ¨åŠ è½½æ–‡ä»¶...',\n\t    mask: true\n\t  });\n\t  \n\t  // #ifdef H5\n\t  // H5å¹³å°å¯ä»¥ç›´æ¥åœ¨æ–°çª—å£æ‰“å¼€æ–‡ä»¶é“¾æ¥\n\t  window.open(url, '_blank');\n\t  uni.hideLoading();\n\t  // #endif\n\t  \n\t  // #ifdef APP-PLUS || MP-WEIXIN\n\t  uni.downloadFile({\n\t    url: url,\n\t    success: (res) => {\n\t      uni.hideLoading();\n\t      if (res.statusCode === 200) {\n\t        // #ifdef APP-PLUS\n\t        uni.openDocument({\n\t          filePath: res.tempFilePath,\n\t          success: function() {\n\t            console.log('æ‰“å¼€æ–‡ä»¶æˆåŠŸ');\n\t          },\n\t          fail: function(err) {\n\t            console.error('æ‰“å¼€æ–‡ä»¶å¤±è´¥:', err);\n\t            uni.showToast({ title: 'æ— æ³•æ‰“å¼€æ­¤ç±»å‹æ–‡ä»¶', icon: 'none' });\n\t          }\n\t        });\n\t        // #endif\n\t        \n\t        // #ifdef MP-WEIXIN\n\t        // å¾®ä¿¡å°ç¨‹åºç¯å¢ƒ\n\t        wx.openDocument({\n\t          filePath: res.tempFilePath,\n\t          showMenu: true, // æ˜¾ç¤ºå³ä¸Šè§’èœå•ï¼Œå¯ä»¥è½¬å‘ã€æ”¶è—ç­‰æ“ä½œ\n\t          fileType: getFileType(url), // å°è¯•è·å–æ–‡ä»¶ç±»å‹\n\t          success: function() {\n\t            console.log('æ‰“å¼€æ–‡ä»¶æˆåŠŸ');\n\t          },\n\t          fail: function(err) {\n\t            console.error('å¾®ä¿¡å°ç¨‹åºæ‰“å¼€æ–‡ä»¶å¤±è´¥:', err);\n\t            // å¦‚æœæ‰“å¼€å¤±è´¥ï¼Œæç¤ºç”¨æˆ·å¤åˆ¶é“¾æ¥\n\t            uni.showModal({\n\t              title: 'æ‰“å¼€å¤±è´¥',\n\t              content: 'æ— æ³•æ‰“å¼€æ­¤ç±»å‹æ–‡ä»¶ï¼Œæ˜¯å¦å¤åˆ¶é“¾æ¥åæ‰‹åŠ¨æ‰“å¼€ï¼Ÿ',\n\t              confirmText: 'å¤åˆ¶é“¾æ¥',\n\t              success: (res) => {\n\t                if (res.confirm) {\n\t                  uni.setClipboardData({\n\t                    data: url,\n\t                    success: () => {\n\t                      uni.showToast({ title: 'é“¾æ¥å·²å¤åˆ¶', icon: 'success' });\n\t                    }\n\t                  });\n\t                }\n\t              }\n\t            });\n\t          }\n\t        });\n\t        // #endif\n\t      } else {\n\t        uni.showToast({ title: 'ä¸‹è½½æ–‡ä»¶å¤±è´¥', icon: 'none' });\n\t      }\n\t    },\n\t    fail: (err) => {\n\t      uni.hideLoading();\n\t      console.error('ä¸‹è½½æ–‡ä»¶å¤±è´¥:', err);\n\t      uni.showToast({ title: 'ä¸‹è½½æ–‡ä»¶å¤±è´¥', icon: 'none' });\n\t    }\n\t  });\n\t  // #endif\n\t  \n\t  // #ifdef MP-ALIPAY || MP-BAIDU || MP-TOUTIAO || MP-QQ\n\t  // å…¶ä»–å°ç¨‹åºå¹³å°ï¼Œæä¾›å¤åˆ¶é“¾æ¥é€‰é¡¹\n\t  uni.hideLoading();\n\t  uni.showModal({\n\t    title: 'æŸ¥çœ‹æ–‡ä»¶',\n\t    content: 'å½“å‰å¹³å°ä¸æ”¯æŒç›´æ¥æŸ¥çœ‹æ–‡ä»¶ï¼Œæ˜¯å¦å¤åˆ¶é“¾æ¥ï¼Ÿ',\n\t    confirmText: 'å¤åˆ¶é“¾æ¥',\n\t    success: (res) => {\n\t      if (res.confirm) {\n\t        uni.setClipboardData({\n\t          data: url,\n\t          success: () => {\n\t            uni.showToast({ title: 'é“¾æ¥å·²å¤åˆ¶', icon: 'success' });\n\t          }\n\t        });\n\t      }\n\t    }\n\t  });\n\t  // #endif\n\t};\n\n\t/**\n\t * æ ¹æ®URLè·å–æ–‡ä»¶ç±»å‹\n\t */\n\tconst getFileType = (url) => {\n\t  if (!url) return '';\n\t  \n\t  const extension = url.split('.').pop().toLowerCase();\n\t  \n\t  // æ˜ å°„å¸¸è§æ–‡ä»¶æ‰©å±•ååˆ°å¾®ä¿¡æ–‡æ¡£ç±»å‹\n\t  const typeMap = {\n\t    'doc': 'doc',\n\t    'docx': 'doc',\n\t    'xls': 'xls',\n\t    'xlsx': 'xls',\n\t    'ppt': 'ppt',\n\t    'pptx': 'ppt',\n\t    'pdf': 'pdf',\n\t    'txt': 'txt'\n\t  };\n\t  \n\t  return typeMap[extension] || '';\n\t};\n\t\n\t/**\n\t * æ‰“å¼€ä½ç½®\n\t */\n\tconst openLocation = (content) => {\n\t  try {\n\t    const locationData = typeof content === 'string' ? JSON.parse(content) : content;\n\t    uni.openLocation({\n\t      latitude: Number(locationData.latitude),\n\t      longitude: Number(locationData.longitude),\n\t      name: locationData.name || 'ä½ç½®ä¿¡æ¯',\n\t      address: locationData.address || '',\n\t      success: () => {\n\t        console.log('æ‰“å¼€ä½ç½®æˆåŠŸ');\n\t      },\n\t      fail: (err) => {\n\t        console.error('æ‰“å¼€ä½ç½®å¤±è´¥:', err);\n\t        uni.showToast({ title: 'æ‰“å¼€ä½ç½®å¤±è´¥', icon: 'none' });\n\t      }\n\t    });\n\t  } catch (e) {\n\t    console.error('è§£æä½ç½®ä¿¡æ¯å¤±è´¥:', e);\n\t    uni.showToast({ title: 'ä½ç½®ä¿¡æ¯æ— æ•ˆ', icon: 'none' });\n\t  }\n\t};\n\t\n\t/**\n\t * é€‰æ‹©å›¾ç‰‡å¹¶å‘é€\n\t */\n\tconst chooseImage = () => {\n\t  uni.chooseImage({\n\t    count: 1,\n\t    sizeType: ['compressed'],\n\t    sourceType: ['album', 'camera'],\n\t    success: async (res) => {\n\t      const tempFilePath = res.tempFilePaths[0];\n\t      \n\t      // æ£€æŸ¥WebSocketè¿æ¥çŠ¶æ€\n\t      if (!wsClient.isConnected) {\n\t        // å°è¯•é‡æ–°è¿æ¥\n\t        try {\n\t          uni.showLoading({ title: 'æ­£åœ¨è¿æ¥èŠå¤©æœåŠ¡...' });\n\t          // ä½¿ç”¨api.jsä¸­çš„baseURLï¼Œä¼ å…¥falseé¿å…æ–­å¼€ç°æœ‰è¿æ¥\n\t          await wsClient.connect(apiModule.baseURL || 'localhost:8081', false);\n\t          uni.hideLoading();\n\t        } catch (error) {\n\t          uni.hideLoading();\n\t          uni.showToast({\n\t            title: 'èŠå¤©æœåŠ¡è¿æ¥å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•',\n\t            icon: 'none'\n\t          });\n\t          console.error('èŠå¤©æœåŠ¡è¿æ¥å¤±è´¥:', error);\n\t          return;\n\t        }\n\t      }\n\t      \n\t      try {\n\t        // æ˜¾ç¤ºä¸Šä¼ ä¸­æç¤º\n\t        uni.showLoading({\n\t          title: 'æ­£åœ¨ä¸Šä¼ å›¾ç‰‡...',\n\t          mask: true\n\t        });\n\t        \n\t        // ä¸Šä¼ æ–‡ä»¶\n\t        const uploadRes = await apiModule.common.upload(tempFilePath);\n\t        uni.hideLoading();\n\t        \n\t        if (uploadRes.code === 200 && uploadRes.data && uploadRes.data.url) {\n\t          const mediaUrl = uploadRes.data.url;\n\t          \n\t          // åˆ›å»ºæœ¬åœ°æ¶ˆæ¯\n\t          const timestamp = Date.now();\n\t          const localMsg = {\n\t            id: `local-${timestamp}`,\n\t            groupId: groupId.value,\n\t            senderId: userId.value,\n\t            senderName: userName.value,\n\t            senderAvatar: userAvatar.value || '/static/images/avatar-default.png',\n\t            createTime: timestamp,\n\t            content: '[å›¾ç‰‡]',\n\t            contentType: 1, // å›¾ç‰‡ç±»å‹\n\t            mediaUrl: mediaUrl,\n\t            isLocalMessage: true\n\t          };\n\t          \n\t          // æ·»åŠ åˆ°æ¶ˆæ¯åˆ—è¡¨æœ«å°¾\n\t          messages.value.push(localMsg);\n\t          nextTick(() => {\n\t            scrollIntoViewId.value = 'msg-' + localMsg.id;\n\t          });\n\t          \n\t          // å‘é€æ¶ˆæ¯åˆ°WebSocket\n\t          if (wsClient.isConnected) {\n\t            const message = {\n\t              type: 'group_message',\n\t              groupId: groupId.value,\n\t              content: '[å›¾ç‰‡]',\n\t              contentType: 1, // å›¾ç‰‡ç±»å‹\n\t              mediaUrl: mediaUrl,\n\t              localMsgId: localMsg.id\n\t            };\n\t            wsClient.sendMessage(message);\n\t          } else {\n\t            uni.showToast({ title: 'èŠå¤©æœåŠ¡æœªè¿æ¥ï¼Œæ¶ˆæ¯å°†åœ¨é‡è¿åå‘é€', icon: 'none' });\n\t          }\n\t        } else {\n\t          uni.showToast({ \n\t            title: uploadRes.message || 'ä¸Šä¼ å¤±è´¥', \n\t            icon: 'none' \n\t          });\n\t          console.error('å›¾ç‰‡ä¸Šä¼ å“åº”å¼‚å¸¸:', uploadRes);\n\t        }\n\t      } catch (error) {\n\t        uni.hideLoading();\n\t        console.error('ä¸Šä¼ å›¾ç‰‡å¤±è´¥', error);\n\t        uni.showToast({ \n\t          title: 'å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•', \n\t          icon: 'none' \n\t        });\n\t      }\n\t    }\n\t  });\n\t  \n\t  showMorePanel.value = false;\n\t};\n\t\n\t/**\n\t * é€‰æ‹©ä½ç½®å¹¶å‘é€\n\t */\n\tconst chooseLocation = () => {\n\t  uni.chooseLocation({\n\t    success: (res) => {\n\t      if (!res.name || !res.address || !res.latitude || !res.longitude) {\n\t        uni.showToast({ title: 'æœªé€‰æ‹©æœ‰æ•ˆä½ç½®', icon: 'none' });\n\t        return;\n\t      }\n\t      \n\t      // ä½ç½®æ•°æ®æ ¼å¼åŒ–\n\t      const locationData = {\n\t        name: res.name,\n\t        address: res.address,\n\t        latitude: res.latitude,\n\t        longitude: res.longitude\n\t      };\n\t      \n\t      // åˆ›å»ºæœ¬åœ°æ¶ˆæ¯\n\t      const timestamp = Date.now();\n\t      const localMsg = {\n\t        id: `local-${timestamp}`,\n\t        groupId: groupId.value,\n\t        senderId: userId.value,\n\t        senderName: userName.value,\n\t        senderAvatar: userAvatar.value || '/static/images/avatar-default.png',\n\t        createTime: timestamp,\n\t        content: JSON.stringify(locationData),\n\t        contentType: 3, // ä½ç½®ç±»å‹\n\t        isLocalMessage: true\n\t      };\n\t      \n\t      // æ·»åŠ åˆ°æ¶ˆæ¯åˆ—è¡¨æœ«å°¾ï¼ˆä¿æŒæ—¶é—´é¡ºåºï¼‰\n\t      messages.value.push(localMsg);\n\t      nextTick(() => {\n\t        scrollIntoViewId.value = 'msg-' + localMsg.id;\n\t      });\n\t      \n\t      // å‘é€æ¶ˆæ¯åˆ°WebSocket\n\t      if (wsClient.isConnected) {\n\t        const message = {\n\t          type: 'group_message',\n\t          groupId: groupId.value,\n\t          content: JSON.stringify(locationData),\n\t          contentType: 3, // ä½ç½®ç±»å‹\n\t          localMsgId: localMsg.id\n\t        };\n\t        wsClient.sendMessage(message);\n\t      } else {\n\t        uni.showToast({ title: 'èŠå¤©æœåŠ¡æœªè¿æ¥', icon: 'none' });\n\t      }\n\t    },\n\t    fail: (err) => {\n\t      console.error('é€‰æ‹©ä½ç½®å¤±è´¥:', err);\n\t    }\n\t  });\n\t  \n\t  showMorePanel.value = false;\n\t};\n\t\n\t/**\n\t * é€‰æ‹©æ–‡ä»¶å¹¶å‘é€\n\t */\n\tconst chooseFile = () => {\n\t  // ç”±äºH5å’Œå°ç¨‹åºå¹³å°APIä¸åŒï¼Œéœ€è¦åšå…¼å®¹å¤„ç†\n\t  // #ifdef APP-PLUS || H5\n\t  uni.chooseFile({\n\t    count: 1,\n\t    extension: ['.doc', '.docx', '.pdf', '.xls', '.xlsx', '.ppt', '.pptx', '.txt'],\n\t    success: async (res) => {\n\t      handleFileUpload(res.tempFiles[0].path);\n\t    }\n\t  });\n\t  // #endif\n\t  \n\t  // #ifdef MP-WEIXIN\n\t  wx.chooseMessageFile({\n\t    count: 1,\n\t    type: 'file',\n\t    extension: ['doc', 'docx', 'pdf', 'xls', 'xlsx', 'ppt', 'pptx', 'txt'],\n\t    success: async (res) => {\n\t      if (res.tempFiles && res.tempFiles.length > 0) {\n\t        const file = res.tempFiles[0];\n\t        console.log('é€‰æ‹©çš„æ–‡ä»¶:', file);\n\t        handleFileUpload(file.path, file.name);\n\t      }\n\t    },\n\t    fail: (err) => {\n\t      console.error('é€‰æ‹©æ–‡ä»¶å¤±è´¥:', err);\n\t  uni.showToast({\n\t        title: 'é€‰æ‹©æ–‡ä»¶å¤±è´¥',\n\t        icon: 'none'\n\t      });\n\t    }\n\t  });\n\t  // #endif\n\t  \n\t  // #ifdef MP-ALIPAY || MP-BAIDU || MP-TOUTIAO || MP-QQ\n\t  uni.showToast({\n\t    title: 'å½“å‰å¹³å°æš‚ä¸æ”¯æŒæ–‡ä»¶å‘é€',\n\t    icon: 'none'\n\t  });\n\t  // #endif\n\t  \n\t  showMorePanel.value = false;\n\t};\n\t\n\t/**\n\t * å¤„ç†æ–‡ä»¶ä¸Šä¼ å’Œå‘é€\n\t */\n\tconst handleFileUpload = async (filePath, fileName = '') => {\n\t  try {\n\t    // æ£€æŸ¥WebSocketè¿æ¥çŠ¶æ€\n\t    if (!wsClient.isConnected) {\n\t      // å°è¯•é‡æ–°è¿æ¥\n\t      try {\n\t        uni.showLoading({ title: 'æ­£åœ¨è¿æ¥èŠå¤©æœåŠ¡...' });\n\t        // ä½¿ç”¨api.jsä¸­çš„baseURLï¼Œä¼ å…¥falseé¿å…æ–­å¼€ç°æœ‰è¿æ¥\n\t        await wsClient.connect(apiModule.baseURL || 'localhost:8081', false);\n\t        uni.hideLoading();\n\t      } catch (error) {\n\t        uni.hideLoading();\n\t        uni.showToast({\n\t          title: 'èŠå¤©æœåŠ¡è¿æ¥å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•',\n\t          icon: 'none'\n\t        });\n\t        console.error('èŠå¤©æœåŠ¡è¿æ¥å¤±è´¥:', error);\n\t        return;\n\t      }\n\t    }\n\t    \n\t    // æ˜¾ç¤ºä¸Šä¼ ä¸­æç¤º\n\t    uni.showLoading({\n\t      title: 'æ­£åœ¨ä¸Šä¼ æ–‡ä»¶...',\n\t      mask: true\n\t    });\n\t    \n\t    // ä¸Šä¼ æ–‡ä»¶\n\t    const uploadRes = await apiModule.common.upload(filePath);\n\t    uni.hideLoading();\n\t    \n\t    if (uploadRes.code === 200 && uploadRes.data && uploadRes.data.url) {\n\t      const mediaUrl = uploadRes.data.url;\n\t      const displayFileName = fileName || uploadRes.data.newFileName || extractFileName(filePath);\n\t      \n\t      // åˆ›å»ºæœ¬åœ°æ¶ˆæ¯\n\t      const timestamp = Date.now();\n\t      const localMsg = {\n\t        id: `local-${timestamp}`,\n\t        groupId: groupId.value,\n\t        senderId: userId.value,\n\t        senderName: userName.value,\n\t        senderAvatar: userAvatar.value || '/static/images/avatar-default.png',\n\t        createTime: timestamp,\n\t        content: displayFileName, // å°†æ–‡ä»¶åä½œä¸ºæ¶ˆæ¯å†…å®¹ï¼Œæ–¹ä¾¿æ˜¾ç¤º\n\t        contentType: 2, // æ–‡ä»¶ç±»å‹\n\t        mediaUrl: mediaUrl,\n\t        isLocalMessage: true\n\t      };\n\t      \n\t            // æ·»åŠ åˆ°æ¶ˆæ¯åˆ—è¡¨æœ«å°¾ï¼ˆä¿æŒæ—¶é—´é¡ºåºï¼‰\n      messages.value.push(localMsg);\n\t      nextTick(() => {\n\t        scrollIntoViewId.value = 'msg-' + localMsg.id;\n\t      });\n\t      \n\t      // å‘é€æ¶ˆæ¯åˆ°WebSocket\n\t      if (wsClient.isConnected) {\n\t        const message = {\n\t          type: 'group_message',\n\t          groupId: groupId.value,\n\t          content: displayFileName, // å°†æ–‡ä»¶åä½œä¸ºæ¶ˆæ¯å†…å®¹\n\t          contentType: 2, // æ–‡ä»¶ç±»å‹\n\t          mediaUrl: mediaUrl,\n\t          localMsgId: localMsg.id\n\t        };\n\t        wsClient.sendMessage(message);\n\t      } else {\n\t        uni.showToast({ title: 'èŠå¤©æœåŠ¡æœªè¿æ¥ï¼Œæ¶ˆæ¯å°†åœ¨é‡è¿åå‘é€', icon: 'none' });\n\t      }\n\t    } else {\n\t      uni.showToast({ \n\t        title: uploadRes.message || 'ä¸Šä¼ å¤±è´¥', \n\t        icon: 'none' \n\t      });\n\t      console.error('æ–‡ä»¶ä¸Šä¼ å“åº”å¼‚å¸¸:', uploadRes);\n\t    }\n\t  } catch (error) {\n\t    uni.hideLoading();\n\t    console.error('ä¸Šä¼ æ–‡ä»¶å¤±è´¥', error);\n\t    uni.showToast({ \n\t      title: 'æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•', \n\t      icon: 'none' \n\t    });\n\t  }\n\t};\n\n\t/**\n\t * è·³è½¬åˆ°ç¾¤ç»„è®¾ç½®é¡µé¢\n\t */\n\tconst goToSettings = () => {\n\t  console.log('[å¯¼èˆª] è·³è½¬åˆ°è®¾ç½®é¡µé¢, groupId:', groupId.value);\n\t  if (!groupId.value) {\n\t\tuni.showToast({\n\t\t  title: 'ç¾¤ç»„IDæ— æ•ˆ',\n\t\t  icon: 'none'\n\t\t});\n\t\treturn;\n\t  }\n\t  uni.navigateTo({\n\t\turl: `/pages/chat/settings?id=${groupId.value}`,\n\t\tsuccess: () => {\n\t\t  console.log('[å¯¼èˆª] æˆåŠŸè·³è½¬åˆ°è®¾ç½®é¡µé¢');\n\t\t},\n\t\tfail: (err) => {\n\t\t  console.error('[å¯¼èˆª] è·³è½¬å¤±è´¥:', err);\n\t\t  uni.showToast({\n\t\t\ttitle: 'æ‰“å¼€è®¾ç½®é¡µé¢å¤±è´¥',\n\t\t\ticon: 'none'\n\t\t  });\n\t\t}\n\t  });\n\t};\n\n\t/**\n\t * åˆ‡æ¢æˆå‘˜ä¾§è¾¹æ æ˜¾ç¤ºçŠ¶æ€\n\t */\n\tconst toggleMemberDrawer = () => {\n\t  if (!showMemberDrawer.value) {\n\t\t// æ‰“å¼€ä¾§è¾¹æ æ—¶åŠ è½½æˆå‘˜åˆ—è¡¨\n\t\tloadMembers();\n\t  }\n\t  showMemberDrawer.value = !showMemberDrawer.value;\n\t};\n\n\t/**\n\t * å…³é—­æˆå‘˜ä¾§è¾¹æ \n\t */\n\tconst closeMemberDrawer = () => {\n\t  showMemberDrawer.value = false;\n\t  // å…³é—­æ—¶æ¸…ç©ºæœç´¢å…³é”®è¯\n\t  searchKeyword.value = '';\n\t};\n\n\t/**\n\t * åŠ è½½ç¾¤æˆå‘˜åˆ—è¡¨\n\t */\n\tconst loadMembers = async () => {\n\t  if (!groupId.value) {\n\t\tconsole.error('[æˆå‘˜åˆ—è¡¨] ç¾¤ç»„IDä¸ºç©º');\n\t\treturn;\n\t  }\n\n\t  isLoadingMembers.value = true;\n\n\t  try {\n\t\tconsole.log('[æˆå‘˜åˆ—è¡¨] å¼€å§‹åŠ è½½ç¾¤æˆå‘˜, groupId:', groupId.value);\n\n\t\t// å…ˆè·å–åœ¨çº¿ç”¨æˆ·åˆ—è¡¨\n\t\tawait fetchOnlineUsers();\n\n\t\t// ä½¿ç”¨groupIdè°ƒç”¨ç¾¤ç»„æˆå‘˜æ¥å£\n\t\tconsole.log('[æˆå‘˜åˆ—è¡¨] ä½¿ç”¨groupIdè·å–ç¾¤ç»„æˆå‘˜åˆ—è¡¨:', groupId.value);\n\t\tconst res = await chatAPI.getGroupMembers(groupId.value);\n\t\tconsole.log('[æˆå‘˜åˆ—è¡¨] APIå“åº”:', res);\n\n\t\tif (res.code === 200 && res.data) {\n\t\t  // å¤„ç†è¿”å›çš„æˆå‘˜æ•°æ®\n\t\t  const members = res.data || [];\n\t\t  memberList.value = members.map(member => ({\n\t\t\tuserId: member.userId,\n\t\t\tusername: member.username || member.nickname,\n\t\t\tnickname: member.nickname || member.username,\n\t\t\tavatar: member.avatar,\n\t\t\tstudentId: member.studentId,\n\t\t\trole: member.role || 0, // 0=æ™®é€šæˆå‘˜, 1=ç®¡ç†å‘˜, 2=ç¾¤ä¸»\n\t\t\tjoinTime: member.joinTime || Date.now(),\n\t\t\tisOnline: member.isOnline || false // åç«¯å·²ç»è¿”å›åœ¨çº¿çŠ¶æ€\n\t\t  }));\n\n\t\t  console.log('[æˆå‘˜åˆ—è¡¨] æˆå‘˜æ•°æ®å¤„ç†å®Œæˆï¼Œå…±', memberList.value.length, 'äºº');\n\n\t\t  // æ£€æŸ¥å½“å‰ç”¨æˆ·æ˜¯å¦æ˜¯ç¾¤ä¸»\n\t\t  const currentUserMember = memberList.value.find(m => m.userId === userId.value);\n\t\t  if (currentUserMember) {\n\t\t\tisOwner.value = currentUserMember.role === 2;\n\t\t\tconsole.log('[æˆå‘˜åˆ—è¡¨] å½“å‰ç”¨æˆ·è§’è‰²:', isOwner.value ? 'ç¾¤ä¸»' : currentUserMember.role === 1 ? 'ç®¡ç†å‘˜' : 'æ™®é€šæˆå‘˜');\n\t\t  }\n\t\t} else {\n\t\t  console.error('[æˆå‘˜åˆ—è¡¨] APIè¿”å›é”™è¯¯:', res.msg || 'æœªçŸ¥é”™è¯¯');\n\t\t  uni.showToast({\n\t\t\ttitle: res.msg || 'åŠ è½½æˆå‘˜åˆ—è¡¨å¤±è´¥',\n\t\t\ticon: 'none'\n\t\t  });\n\t\t}\n\t  } catch (error) {\n\t\tconsole.error('[æˆå‘˜åˆ—è¡¨] åŠ è½½å¤±è´¥:', error);\n\t\tuni.showToast({\n\t\t  title: 'åŠ è½½æˆå‘˜åˆ—è¡¨å¤±è´¥',\n\t\t  icon: 'none'\n\t\t});\n\t  } finally {\n\t\tisLoadingMembers.value = false;\n\t  }\n\t};\n\n\t/**\n\t * è·å–åœ¨çº¿ç”¨æˆ·åˆ—è¡¨\n\t */\n\tconst fetchOnlineUsers = async () => {\n\t  try {\n\t\tconst res = await chatAPI.getOnlineUsers();\n\t\tif (res.code === 200 && res.data && res.data.onlineUserIds) {\n\t\t  // å°†æ•°ç»„è½¬æ¢ä¸ºSetä»¥ä¾¿å¿«é€ŸæŸ¥æ‰¾\n\t\t  onlineUserIds.value = new Set(res.data.onlineUserIds.map(id => Number(id)));\n\t\t  console.log('[åœ¨çº¿ç”¨æˆ·] è·å–åœ¨çº¿ç”¨æˆ·åˆ—è¡¨æˆåŠŸï¼Œåœ¨çº¿äººæ•°:', res.data.onlineCount);\n\t\t  return true;\n\t\t}\n\t  } catch (error) {\n\t\tconsole.error('[åœ¨çº¿ç”¨æˆ·] è·å–åœ¨çº¿ç”¨æˆ·åˆ—è¡¨å¤±è´¥:', error);\n\t\treturn false;\n\t  }\n\t};\n\n\t/**\n\t * æ£€æŸ¥æˆå‘˜åœ¨çº¿çŠ¶æ€ï¼ˆåŸºäºWebSocketè¿æ¥ï¼‰\n\t */\n\tconst checkMemberOnlineStatus = (userId) => {\n\t  // ä½¿ç”¨ä»åç«¯è·å–çš„åœ¨çº¿ç”¨æˆ·åˆ—è¡¨\n\t  return onlineUserIds.value.has(Number(userId));\n\t};\n\n\t/**\n\t * å¤„ç†æœç´¢è¾“å…¥\n\t */\n\tconst handleSearchInput = debounce((e) => {\n\t  console.log('[æˆå‘˜æœç´¢] æœç´¢å…³é”®è¯:', searchKeyword.value);\n\t}, 300);\n\n\t/**\n\t * æ¸…ç©ºæœç´¢\n\t */\n\tconst clearSearch = () => {\n\t  searchKeyword.value = '';\n\t};\n\n\t// é¡µé¢åŠ è½½\n\tonLoad(async (option) => {\n\t  chatPageCount++; // é¡µé¢æ ˆå¢åŠ \n\t  await initUserInfo();\n\t  \n\t  if (option.id) {\n\t    groupId.value = parseInt(option.id);\n\t    if (option.name) {\n\t      roomInfo.name = decodeURIComponent(option.name);\n\t    }\n\t    \n\t    console.log(`è¿›å…¥èŠå¤©å®¤ï¼Œç¾¤ç»„ID: ${groupId.value}, åç§°: ${roomInfo.name}`);\n\t    \n\t    // è¿æ¥WebSocketï¼ˆå¦‚æœæœªè¿æ¥ï¼‰å¹¶æ›´æ–°æ¶ˆæ¯å¤„ç†å™¨\n\t    connectWebSocket();\n\t    \n\t    await loadGroupDetail();\n\t    await loadInitialMessages();\n\t  }\n\t});\n\t\n\t// é¡µé¢å¸è½½\n\tonUnload(() => {\n\t  chatPageCount--;\n\t  if (chatPageCount === 0) {\n\t    // å½“æ‰€æœ‰èŠå¤©é¡µé¢éƒ½å…³é—­æ—¶ï¼Œæ‰æ–­å¼€WebSocket\n\t    if (wsClient.isConnected) {\n\t      wsClient.disconnect();\n\t      console.log('æ‰€æœ‰èŠå¤©é¡µé¢å·²å…³é—­ï¼Œæ–­å¼€WebSocketè¿æ¥');\n\t    }\n\t  }\n\t});\n\t\n\t// é¡µé¢éšè—ï¼ˆä¿æŒè¿æ¥ï¼‰\n\tonHide(() => {\n\t  console.log('é¡µé¢éšè—ï¼Œä¿æŒWebSocketè¿æ¥');\n\t});\n\t</script>\n\n\t<style lang=\"scss\" scoped>\n\t.nav-right-btn {\n\t  padding: 0 20rpx;\n\t  height: 100%;\n\t  display: flex;\n\t  align-items: center;\n\t  justify-content: center;\n\t}\n\n\t.chat-room-container {\n\t  display: flex;\n\t  flex-direction: column;\n\t  height: 100vh;\n\t  position: relative;\n\t  box-sizing: border-box;\n\t  padding-bottom: 120rpx; /* ä¸ºåº•éƒ¨è¾“å…¥åŒºåŸŸç•™å‡ºç©ºé—´ */\n\t}\n\n\t/* é¢æ¿å±•å¼€æ—¶ï¼Œä¸ºæ¶ˆæ¯åˆ—è¡¨é¢å¤–é¢„ç•™ç©ºé—´ï¼ˆè¾“å…¥åŒº+é¢æ¿é«˜åº¦ï¼‰ */\n\t.chat-room-container.panel-open {\n    padding-bottom: 420rpx; /* 120rpx è¾“å…¥åŒº + 300rpx é¢æ¿ */\n\t}\n\n\t.chat-list {\n\t  flex: 1;\n\t  padding: 20rpx;\n\t  box-sizing: border-box;\n\t  background-color: #F6F6F6;\n\t  height: calc(100vh - 120rpx - var(--status-bar-height) - 44px);\n\t  /* ä¼˜åŒ–æ»šåŠ¨æ€§èƒ½ */\n\t  -webkit-overflow-scrolling: touch;\n  /* ç¡®ä¿æ»šåŠ¨è§†å›¾ä»é¡¶éƒ¨å¼€å§‹ */\n  display: flex;\n  flex-direction: column;\n\t  \n\t  .load-more {\n\t    padding: 20rpx 0;\n\t    text-align: center;\n\t    \n\t    text {\n\t      font-size: 24rpx;\n\t      color: #999;\n\t    }\n\t    \n\t    .loading-icon {\n\t      display: inline-block;\n\t      width: 30rpx;\n\t      height: 30rpx;\n\t      border: 2rpx solid #999;\n\t      border-radius: 50%;\n\t      border-top-color: transparent;\n\t      animation: loading 0.8s linear infinite;\n\t      margin-right: 10rpx;\n\t      vertical-align: middle;\n\t    }\n\t    \n\t    @keyframes loading {\n\t      from { transform: rotate(0deg); }\n\t      to { transform: rotate(360deg); }\n\t    }\n\t  }\n\t  \n\t  .messages-container {\n    /* ä½¿ç”¨flexå¸ƒå±€ï¼Œæ¶ˆæ¯ä»ä¸Šåˆ°ä¸‹æ­£å¸¸æ’åˆ— */\n\t    display: flex;\n    flex-direction: column;\n    /* è®©å®¹å™¨æ ¹æ®å†…å®¹è‡ªé€‚åº”é«˜åº¦ï¼Œä¸å¼ºåˆ¶å æ»¡ */\n    flex: 1;\n    justify-content: flex-start;\n\t    \n\t    .message-item {\n\t      /* æ¯ä¸ªæ¶ˆæ¯é¡¹ */\n\t      width: 100%;\n\t      margin-bottom: 10rpx;\n\t    }\n\t  }\n\t  \n\t  .time-divider {\n\t\ttext-align: center;\n\t\tpadding: 10rpx 0;\n\t\tmargin: 20rpx 0;\n\t\t\n\t\ttext {\n\t\t  font-size: 24rpx;\n\t\t  color: #999;\n\t\t  background-color: rgba(0,0,0,0.1);\n\t\t  border-radius: 10rpx;\n\t\t  padding: 4rpx 16rpx;\n\t\t}\n\t  }\n\t  \n\t  .message-row {\n\t\tdisplay: flex;\n\t\tmargin-bottom: 30rpx;\n\t\talign-items: flex-start;\n\t\twill-change: transform; /* æç¤ºæµè§ˆå™¨è¿™ä¸ªå…ƒç´ ä¼šå˜åŒ–ï¼Œä¼˜åŒ–æ¸²æŸ“ */\n\t\t\n\t\t.avatar-container {\n\t\t  width: 80rpx;\n\t\t  height: 80rpx;\n\t\t  flex-shrink: 0;\n\t\t}\n\t\t\n\t\t.avatar {\n\t\t  width: 80rpx;\n\t\t  height: 80rpx;\n\t\t  border-radius: 8rpx;\n\t\t}\n\t\t\n\t\t.message-content {\n\t\t  max-width: 70%;\n\t\t  padding: 0 20rpx;\n\t\t  \n\t\t  .sender-name {\n\t\t\tfont-size: 26rpx;\n\t\t\tcolor: #999;\n\t\t\tmargin-bottom: 6rpx;\n\t\t  }\n\t\t  \n\t\t  .bubble {\n\t\t\tpadding: 20rpx;\n\t\t\tbackground: #FFFFFF;\n\t\t\tborder-radius: 4rpx 16rpx 16rpx 16rpx;\n\t\t\t/* æ”¯æŒä¸­è‹±æ–‡è‡ªåŠ¨æ¢è¡Œ */\n\t\t\tword-break: break-all;\n\t\t\toverflow-wrap: anywhere;\n\t\t\tword-wrap: break-word;\n\t\t\tdisplay: inline-block;\n\t\t\tmin-width: 40rpx;\n\t\t\tmax-width: 100%;\n\t\t\tbox-sizing: border-box;\n\t\t\twill-change: transform; /* ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ */\n\t\t  }\n\t\t  \n\t\t  .time {\n\t\t\tfont-size: 24rpx;\n\t\t\tcolor: #999;\n\t\t\tmargin-top: 8rpx;\n\t\t\ttext-align: left;\n\t\t  }\n\t\t  \n\t\t  &.self {\n\t\t\ttext-align: right;\n\t\t\t\n\t\t\t.bubble {\n\t\t\t  background: #95EC69;\n\t\t\t  border-radius: 16rpx 4rpx 16rpx 16rpx;\n\t\t\t}\n\t\t\t\n\t\t\t.time {\n\t\t\t  text-align: right;\n\t\t\t}\n\t\t  }\n\t\t}\n\t\t\n\t\t&.self {\n\t\t  justify-content: flex-end;\n\t\t}\n\t\t\n\t\t.text {\n\t\t  font-size: 28rpx;\n\t\t  line-height: 40rpx;\n\t\t  color: #333;\n\t\t  /* æ–‡æœ¬æ”¯æŒä¸­è‹±æ–‡æŠ˜è¡Œ */\n\t\t  word-break: break-all;\n\t\t  overflow-wrap: anywhere;\n\t\t  word-wrap: break-word;\n\t\t  white-space: pre-line;\n\t\t  max-width: 100%;\n\t\t  display: inline-block;\n\t\t}\n\t\t\n\t\t.image {\n\t\t  max-width: 400rpx;\n\t\t  border-radius: 8rpx;\n\t\t}\n\t\t\n\t\t.file-box, .location-box {\n\t\t  display: flex;\n\t\t  align-items: center;\n\t\t}\n\t\t\n\t\t.file-name, .location-name {\n\t\t  font-size: 28rpx;\n\t\t  color: #333;\n\t\t  margin-left: 10rpx;\n\t\t}\n\t  }\n\t}\n\n\t.input-area {\n\t  display: flex;\n\t  align-items: center;\n\t  padding: 20rpx;\n\t  background: #fff;\n\t  border-top: 1px solid #eee;\n\t  position: fixed;\n\t  left: 0;\n\t  right: 0;\n\t  bottom: 0;\n\t  z-index: 100;\n\t  box-shadow: 0 -2rpx 10rpx rgba(0,0,0,0.05);\n\t  \n\t  .more-btn, .send-btn {\n\t\twidth: 70rpx;\n\t\theight: 70rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tflex-shrink: 0;\n\t  }\n\t  \n\t  .input-wrapper {\n\t\tflex: 1;\n\t\tmargin: 0 20rpx;\n\t\tbackground: #f5f5f5;\n\t\tborder-radius: 8rpx;\n\t\tpadding: 16rpx;\n\t\t\n\t\t.message-input {\n\t\t  width: 100%;\n\t\t  min-height: 40rpx;\n\t\t  max-height: 180rpx;\n\t\t  font-size: 28rpx;\n\t\t  line-height: 1.5;\n\t\t}\n\t  }\n\t  \n\t  .send-btn {\n\t\tbackground: #ddd;\n\t\tborder-radius: 35rpx;\n\t\t\n\t\t&.active {\n\t\t  background: #2979ff;\n\t\t}\n\t  }\n\t}\n\n\t/* é¢æ¿å±•å¼€æ™‚ï¼Œè¼¸å…¥å€ä¸Šç§»åˆ°é¢æ¿ä¸Šæ–¹ */\n\t.input-area.with-panel {\n    bottom: 300rpx; /* èˆ‡é¢æ¿é«˜åº¦ä¸€è‡´ */\n\t}\n\n\t.more-panel {\n\t  display: flex;\n\t  flex-wrap: wrap;\n\t  padding: 30rpx 20rpx;\n\t  background: #fff;\n\t  border-top: 1px solid #eee;\n\t  position: fixed;\n\t  left: 0;\n\t  right: 0;\n\t  bottom: 0; /* å›ºå®šåœ¨æœ€åº•éƒ¨ï¼Œä½æ–¼è¼¸å…¥å€ä¸‹æ–¹ */\n    height: 300rpx; /* å›ºå®šé¢æ¿é«˜åº¦ */\n    overflow: auto;\n\t  z-index: 99;\n\t  box-shadow: 0 -2rpx 10rpx rgba(0,0,0,0.05);\n\t  \n\t  .panel-item {\n\t\twidth: 25%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tmargin-bottom: 30rpx;\n\t\t\n\t\t.panel-icon {\n\t\t  width: 100rpx;\n\t\t  height: 100rpx;\n\t\t  background: #f5f5f5;\n\t\t  border-radius: 20rpx;\n\t\t  display: flex;\n\t\t  align-items: center;\n\t\t  justify-content: center;\n\t\t  margin-bottom: 10rpx;\n\t\t}\n\t\t\n\t\ttext {\n\t\t  font-size: 24rpx;\n\t\t  color: #666;\n\t\t}\n\t  }\n\t}\n\n\t/* ==================== æˆå‘˜ä¾§è¾¹æ æ ·å¼ ==================== */\n\n\t// å¯¼èˆªæ å·¦ä¾§å’Œå³ä¾§æŒ‰é’®å®¹å™¨\n\t.nav-left-btns,\n\t.nav-right-btns {\n\t  display: flex;\n\t  align-items: center;\n\t  gap: 20rpx;\n\t  flex-shrink: 0; // é˜²æ­¢æŒ‰é’®è¢«å‹ç¼©\n\t  white-space: nowrap; // é˜²æ­¢æ¢è¡Œ\n\t}\n\n\t// å¯¼èˆªæ å•ä¸ªæŒ‰é’®\n\t.nav-btn {\n\t  position: relative;\n\t  padding: 8rpx;\n\t  cursor: pointer;\n\t  display: flex;\n\t  align-items: center;\n\t  justify-content: center;\n\t  flex-shrink: 0; // é˜²æ­¢æŒ‰é’®è¢«å‹ç¼©\n\t  min-width: 60rpx; // ç¡®ä¿æŒ‰é’®æœ‰æœ€å°å®½åº¦\n\t  min-height: 60rpx; // ç¡®ä¿æŒ‰é’®æœ‰æœ€å°é«˜åº¦\n\t  background: rgba(255, 255, 255, 0.8); // æ·»åŠ åŠé€æ˜èƒŒæ™¯ç¡®ä¿å¯è§\n\t  border-radius: 50%; // åœ†å½¢æŒ‰é’®\n\n\t  .member-count-badge {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tright: 0;\n\t\tmin-width: 32rpx;\n\t\theight: 32rpx;\n\t\tline-height: 32rpx;\n\t\tpadding: 0 8rpx;\n\t\tbackground: #ff4d4f;\n\t\tcolor: #fff;\n\t\tfont-size: 20rpx;\n\t\tborder-radius: 16rpx;\n\t\ttext-align: center;\n\t\ttransform: translate(30%, -30%);\n\t  }\n\t}\n\n\t// å…¼å®¹æ—§çš„å•ç‹¬æŒ‰é’®æ ·å¼ï¼ˆä¿ç•™ä»¥é˜²ä¸‡ä¸€ï¼‰\n\t.nav-left-btn,\n\t.nav-right-btn {\n\t  position: relative;\n\t  padding: 8rpx;\n\t  cursor: pointer;\n\n\t  .member-count-badge {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tright: 0;\n\t\tmin-width: 32rpx;\n\t\theight: 32rpx;\n\t\tline-height: 32rpx;\n\t\tpadding: 0 8rpx;\n\t\tbackground: #ff4d4f;\n\t\tcolor: #fff;\n\t\tfont-size: 20rpx;\n\t\tborder-radius: 16rpx;\n\t\ttext-align: center;\n\t\ttransform: translate(30%, -30%);\n\t  }\n\t}\n\n\t// é®ç½©å±‚\n\t.drawer-mask {\n\t  position: fixed;\n\t  top: 0;\n\t  left: 0;\n\t  width: 100%;\n\t  height: 100vh;\n\t  background: rgba(0, 0, 0, 0.5);\n\t  opacity: 0;\n\t  transition: opacity 0.3s ease;\n\t  z-index: 998;\n\t  pointer-events: none;\n\n\t  &.show {\n\t\topacity: 1;\n\t\tpointer-events: auto;\n\t  }\n\t}\n\n\t// ä¾§è¾¹æ å®¹å™¨\n\t.member-drawer {\n\t  position: fixed;\n\t  top: 0;\n\t  right: 0;\n\t  width: 80%;\n\t  max-width: 600rpx;\n\t  height: 100vh;\n\t  background: #fff;\n\t  transform: translateX(100%);\n\t  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n\t  z-index: 999;\n\t  display: flex;\n\t  flex-direction: column;\n\t  box-shadow: -4rpx 0 16rpx rgba(0, 0, 0, 0.1);\n\n\t  &.show {\n\t\ttransform: translateX(0);\n\t  }\n\t}\n\n\t// ä¾§è¾¹æ å¤´éƒ¨\n\t.drawer-header {\n\t  display: flex;\n\t  align-items: center;\n\t  justify-content: space-between;\n\t  padding: 30rpx;\n\t  border-bottom: 1rpx solid #f0f0f0;\n\t  background: #fff;\n\t  // æ·»åŠ é¡¶éƒ¨marginï¼Œä¸ºå¯¼èˆªæ ç•™å‡ºç©ºé—´\n\t  margin-top: calc(var(--status-bar-height, 40px) + 88rpx);\n\n\t  .drawer-title {\n\t\tdisplay: flex;\n\t\talign-items: baseline;\n\n\t\t.title-text {\n\t\t  font-size: 34rpx;\n\t\t  font-weight: 600;\n\t\t  color: #333;\n\t\t}\n\n\t\t.title-count {\n\t\t  margin-left: 8rpx;\n\t\t  font-size: 26rpx;\n\t\t  color: #999;\n\t\t}\n\t  }\n\n\t  .close-btn {\n\t\tpadding: 8rpx;\n\t\tcursor: pointer;\n\t  }\n\t}\n\n\t// æœç´¢æ \n\t.drawer-search {\n\t  padding: 20rpx 30rpx;\n\t  background: #fff;\n\t  border-bottom: 1rpx solid #f0f0f0;\n\n\t  .search-input-wrapper {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tpadding: 0 20rpx;\n\t\tbackground: #f5f5f5;\n\t\tborder-radius: 40rpx;\n\t\theight: 72rpx;\n\n\t\t.search-input {\n\t\t  flex: 1;\n\t\t  margin: 0 12rpx;\n\t\t  font-size: 28rpx;\n\t\t  background: transparent;\n\t\t  border: none;\n\t\t}\n\n\t\t.clear-btn {\n\t\t  padding: 8rpx;\n\t\t  cursor: pointer;\n\t\t}\n\t  }\n\t}\n\n\t// ä¾§è¾¹æ å†…å®¹åŒº\n\t.drawer-content {\n\t  flex: 1;\n\t  overflow-y: auto;\n\t}\n\n\t// æˆå‘˜åˆ—è¡¨\n\t.member-list {\n\t  padding: 0;\n\t}\n\n\t.member-item {\n\t  display: flex;\n\t  align-items: center;\n\t  padding: 24rpx 30rpx;\n\t  border-bottom: 1rpx solid #f5f5f5;\n\t  transition: background 0.2s;\n\n\t  &:active {\n\t\tbackground: #f9f9f9;\n\t  }\n\n\t  // å¤´åƒå®¹å™¨\n\t  .avatar-wrapper {\n\t\tposition: relative;\n\t\tmargin-right: 20rpx;\n\n\t\t.avatar {\n\t\t  width: 80rpx;\n\t\t  height: 80rpx;\n\t\t  border-radius: 50%;\n\t\t  background: #f0f0f0;\n\t\t}\n\n\t\t// åœ¨çº¿çŠ¶æ€å°åœ†ç‚¹\n\t\t.online-dot {\n\t\t  position: absolute;\n\t\t  bottom: 2rpx;\n\t\t  right: 2rpx;\n\t\t  width: 20rpx;\n\t\t  height: 20rpx;\n\t\t  border-radius: 50%;\n\t\t  border: 3rpx solid #fff;\n\t\t  box-shadow: 0 0 6rpx rgba(0, 0, 0, 0.1);\n\n\t\t  &.online {\n\t\t\tbackground: #52c41a;\n\t\t  }\n\n\t\t  &.offline {\n\t\t\tbackground: #bfbfbf;\n\t\t  }\n\t\t}\n\t  }\n\n\t  // æˆå‘˜ä¿¡æ¯\n\t  .member-info {\n\t\tflex: 1;\n\t\tmin-width: 0; // é˜²æ­¢flexå­å…ƒç´ æº¢å‡º\n\n\t\t.nickname {\n\t\t  font-size: 30rpx;\n\t\t  font-weight: 600;\n\t\t  color: #333;\n\t\t  line-height: 42rpx;\n\t\t  overflow: hidden;\n\t\t  text-overflow: ellipsis;\n\t\t  white-space: nowrap;\n\n\t\t  .role-badge {\n\t\t\tmargin-left: 6rpx;\n\t\t\tfont-size: 28rpx;\n\t\t  }\n\t\t}\n\n\t\t.member-meta {\n\t\t  margin-top: 6rpx;\n\n\t\t  .student-id {\n\t\t\tfont-size: 24rpx;\n\t\t\tcolor: #999;\n\t\t  }\n\t\t}\n\t  }\n\n\t  // çŠ¶æ€æ–‡æœ¬\n\t  .member-status {\n\t\t.status-text {\n\t\t  font-size: 24rpx;\n\t\t  padding: 4rpx 12rpx;\n\t\t  border-radius: 12rpx;\n\n\t\t  &.online {\n\t\t\tcolor: #52c41a;\n\t\t\tbackground: #f6ffed;\n\t\t  }\n\n\t\t  &.offline {\n\t\t\tcolor: #999;\n\t\t\tbackground: #f5f5f5;\n\t\t  }\n\t\t}\n\t  }\n\t}\n\n\t// ç©ºçŠ¶æ€\n\t.empty-state {\n\t  display: flex;\n\t  flex-direction: column;\n\t  align-items: center;\n\t  justify-content: center;\n\t  padding: 120rpx 60rpx;\n\n\t  .empty-text {\n\t\tmargin-top: 24rpx;\n\t\tfont-size: 28rpx;\n\t\tcolor: #999;\n\t  }\n\t}\n\n\t// åŠ è½½ä¸­çŠ¶æ€\n\t.loading-state {\n\t  display: flex;\n\t  flex-direction: column;\n\t  align-items: center;\n\t  justify-content: center;\n\t  padding: 80rpx 60rpx;\n\n\t  .loading-text {\n\t\tmargin-top: 16rpx;\n\t\tfont-size: 26rpx;\n\t\tcolor: #999;\n\t  }\n\t}\n\t</style> ","import MiniProgramPage from 'D:/CODE/capstone-project/club-master/club/club_uniapp/pages/chat/room.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","reactive","getUser","uni","computed","apiModule","setUser","wsClient","chatAPI","nextTick","wx","res","onLoad","onUnload","onHide"],"mappings":"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"}