{"version":3,"file":"myActivities.js","sources":["pages/user/myActivities.vue","../../../../../Software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9teUFjdGl2aXRpZXMudnVl"],"sourcesContent":["<template>\n  <view class=\"my-activities\">\n    <custom-nav-bar title=\"我的活动\" :showBack=\"true\" @backClick=\"goBack\" />\n    <scroll-view\n      scroll-y\n      class=\"activity-list\"\n      refresher-enabled\n      :refresher-triggered=\"refreshing\"\n      @refresherrefresh=\"refreshActivities\"\n      @scrolltolower=\"loadMore\"\n      :show-scrollbar=\"false\"\n      enhanced\n    >\n      <view class=\"list-container\">\n        <view\n          v-for=\"(act, idx) in activityList\"\n          :key=\"idx\"\n          class=\"activity-card\"\n          @tap=\"goToDetail(act)\"\n        >\n          <image\n            class=\"activity-cover\"\n            :src=\"act.poster || '/static/images/default-activity.png'\"\n            mode=\"aspectFill\"\n          />\n          <view class=\"activity-info\">\n            <view class=\"activity-name\">{{ act.title }}</view>\n            <view class=\"status-tags\">\n              <text class=\"status-tag\">{{ getApplyStatusText(act.status) }}</text>\n              <text class=\"status-tag\">{{ getCheckInStatusText(act.checkInStatus) }}</text>\n            </view>\n          </view>\n        </view>\n        <view v-if=\"isLoading\" class=\"loading-more\">\n          <uni-icons type=\"spinner-cycle\" size=\"20\" color=\"#999\" />\n          <text>加载中...</text>\n        </view>\n        <view v-if=\"activityList.length === 0 && !isLoading\" class=\"empty-data\">\n          <text>暂无活动</text>\n        </view>\n      </view>\n    </scroll-view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { getCurrentInstance } from 'vue'\n\nconst { proxy } = getCurrentInstance()\n\nconst activityList = ref([])\nconst page = ref(1)\nconst pageSize = ref(10)\nconst hasMore = ref(true)\nconst isLoading = ref(false)\nconst refreshing = ref(false)\n\n// 加载当前用户报名的活动列表\nconst loadActivities = async () => {\n  if (isLoading.value) return;\n  isLoading.value = true;\n  try {\n    const res = await proxy.$api.activity.getMyActivities();\n    if (res.code === 200) {\n      const applies = res.data || [];\n      // 并行获取活动详情\n      const enriched = await Promise.all(\n        applies.map(async (apply) => {\n          const detailRes = await proxy.$api.activity.getActivityDetail(apply.activityId);\n          if (detailRes.code === 200) {\n            apply.poster = detailRes.data.poster;\n            apply.title = detailRes.data.title;\n          }\n          return apply;\n        })\n      );\n      activityList.value = enriched;\n    }\n  } catch (error) {\n    console.error('加载我的活动失败', error);\n  } finally {\n    isLoading.value = false;\n    refreshing.value = false;\n  }\n};\n\n// 获取报名状态文本\nconst getApplyStatusText = (status) => {\n  switch (status) {\n    case 0: return '待审核';\n    case 1: return '已通过';\n    case 2: return '已拒绝';\n    default: return '未知';\n  }\n};\n\n// 获取签到状态文本\nconst getCheckInStatusText = (status) => {\n  switch (status) {\n    case 0: return '未签到';\n    case 1: return '已签到';\n    default: return '未知';\n  }\n};\n\nconst refreshActivities = () => {\n  refreshing.value = true\n  page.value = 1\n  loadActivities()\n}\n\nconst loadMore = () => {\n  if (hasMore.value && !isLoading.value) loadActivities()\n}\n\nconst goBack = () => {\n  uni.navigateBack()\n}\n\nconst goToDetail = (act) => {\n  uni.navigateTo({ url: `/pages/activity/activityDeatil?id=${act.activityId}` })\n}\n\nonMounted(() => {\n  loadActivities()\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.activity-card {\n  display: flex;\n  padding: 20rpx;\n  margin-bottom: 20rpx;\n  border-radius: 12rpx;\n  background: #fff;\n}\n.activity-cover {\n  width: 80rpx;\n  height: 80rpx;\n  border-radius: 12rpx;\n  margin-right: 20rpx;\n  background: #fff;\n}\n.activity-name {\n  font-size: 30rpx;\n  color: #333;\n  line-height: 80rpx;\n}\n.loading-more,\n.empty-data {\n  text-align: center;\n  padding: 30rpx;\n}\n.status-tags {\n  margin-top: 10rpx;\n  display: flex;\n  gap: 10rpx;\n}\n.status-tag {\n  padding: 4rpx 10rpx;\n  border-radius: 12rpx;\n  font-size: 24rpx;\n  color: #fff;\n  background: #409EFF;\n}\n</style>","import MiniProgramPage from 'D:/CODE/capstone-project/club-master/club/club_uniapp/pages/user/myActivities.vue'\nwx.createPage(MiniProgramPage)"],"names":["getCurrentInstance","ref","uni","onMounted"],"mappings":";;;;;;;;;;;;;;;AAiDA,UAAM,EAAE,MAAO,IAAGA,iCAAoB;AAEtC,UAAM,eAAeC,cAAG,IAAC,EAAE;AAC3B,UAAM,OAAOA,cAAG,IAAC,CAAC;AACDA,kBAAG,IAAC,EAAE;AACvB,UAAM,UAAUA,cAAG,IAAC,IAAI;AACxB,UAAM,YAAYA,cAAG,IAAC,KAAK;AAC3B,UAAM,aAAaA,cAAG,IAAC,KAAK;AAG5B,UAAM,iBAAiB,YAAY;AACjC,UAAI,UAAU;AAAO;AACrB,gBAAU,QAAQ;AAClB,UAAI;AACF,cAAM,MAAM,MAAM,MAAM,KAAK,SAAS,gBAAe;AACrD,YAAI,IAAI,SAAS,KAAK;AACpB,gBAAM,UAAU,IAAI,QAAQ;AAE5B,gBAAM,WAAW,MAAM,QAAQ;AAAA,YAC7B,QAAQ,IAAI,OAAO,UAAU;AAC3B,oBAAM,YAAY,MAAM,MAAM,KAAK,SAAS,kBAAkB,MAAM,UAAU;AAC9E,kBAAI,UAAU,SAAS,KAAK;AAC1B,sBAAM,SAAS,UAAU,KAAK;AAC9B,sBAAM,QAAQ,UAAU,KAAK;AAAA,cAC9B;AACD,qBAAO;AAAA,YACjB,CAAS;AAAA,UACT;AACM,uBAAa,QAAQ;AAAA,QACtB;AAAA,MACF,SAAQ,OAAO;AACdC,sBAAA,MAAA,MAAA,SAAA,qCAAc,YAAY,KAAK;AAAA,MACnC,UAAY;AACR,kBAAU,QAAQ;AAClB,mBAAW,QAAQ;AAAA,MACpB;AAAA,IACH;AAGA,UAAM,qBAAqB,CAAC,WAAW;AACrC,cAAQ,QAAM;AAAA,QACZ,KAAK;AAAG,iBAAO;AAAA,QACf,KAAK;AAAG,iBAAO;AAAA,QACf,KAAK;AAAG,iBAAO;AAAA,QACf;AAAS,iBAAO;AAAA,MACjB;AAAA,IACH;AAGA,UAAM,uBAAuB,CAAC,WAAW;AACvC,cAAQ,QAAM;AAAA,QACZ,KAAK;AAAG,iBAAO;AAAA,QACf,KAAK;AAAG,iBAAO;AAAA,QACf;AAAS,iBAAO;AAAA,MACjB;AAAA,IACH;AAEA,UAAM,oBAAoB,MAAM;AAC9B,iBAAW,QAAQ;AACnB,WAAK,QAAQ;AACb,qBAAgB;AAAA,IAClB;AAEA,UAAM,WAAW,MAAM;AACrB,UAAI,QAAQ,SAAS,CAAC,UAAU;AAAO,uBAAgB;AAAA,IACzD;AAEA,UAAM,SAAS,MAAM;AACnBA,oBAAAA,MAAI,aAAc;AAAA,IACpB;AAEA,UAAM,aAAa,CAAC,QAAQ;AAC1BA,0BAAI,WAAW,EAAE,KAAK,qCAAqC,IAAI,UAAU,IAAI;AAAA,IAC/E;AAEAC,kBAAAA,UAAU,MAAM;AACd,qBAAgB;AAAA,IAClB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7HD,GAAG,WAAW,eAAe;"}