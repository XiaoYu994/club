{"version":3,"file":"auth.js","sources":["utils/auth.js"],"sourcesContent":["/**\n * 认证工具模块\n * 处理token和用户信息的存取\n */\n\n// token存储的key\nconst TOKEN_KEY = 'token';\n// 用户信息存储的key\nconst USER_INFO_KEY = 'club_user_info';\n\n/**\n * 保存token到本地\n * @param {string} token 用户令牌\n */\nexport function setToken(token) {\n  uni.setStorageSync(TOKEN_KEY, token);\n}\n\n/**\n * 获取token\n * @returns {string|null} 用户令牌\n */\nexport function getToken() {\n  return uni.getStorageSync(TOKEN_KEY) || null;\n}\n\n/**\n * 移除token\n */\nexport function removeToken() {\n  uni.removeStorageSync(TOKEN_KEY);\n}\n\n/**\n * 保存用户信息\n * @param {Object} userInfo 用户信息对象\n */\nexport function setUser(userInfo) {\n  uni.setStorageSync(USER_INFO_KEY, userInfo);\n}\n\n/**\n * 获取用户信息\n * @returns {Object|null} 用户信息对象\n */\nexport function getUser() {\n  return uni.getStorageSync(USER_INFO_KEY) || null;\n}\n\n/**\n * 移除用户信息\n */\nexport function removeUser() {\n  uni.removeStorageSync(USER_INFO_KEY);\n}\n\n/**\n * 登录成功处理\n * @param {string} token 用户令牌\n * @param {Object} userInfo 用户信息\n */\nexport function handleLoginSuccess(token, userInfo) {\n  setToken(token);\n  setUser(userInfo);\n}\n\n/**\n * 登出处理\n */\nexport function logout() {\n  removeToken();\n  removeUser();\n}\n\n/**\n * 判断用户是否已登录\n * @returns {boolean} 是否已登录\n */\nexport function isLoggedIn() {\n  return !!getToken() && !!getUser();\n}\n\n/**\n * 判断用户是否是管理员\n * @returns {boolean} 是否是管理员\n */\nexport function isAdmin() {\n  const user = getUser();\n  return user ? user.isAdmin === true : false;\n}\n\n/**\n * 判断用户是否是社团管理员\n * @param {number} clubId 社团ID\n * @returns {boolean} 是否是社团管理员\n */\nexport function isClubAdmin(clubId) {\n  const user = getUser();\n  if (!user || !user.clubs) return false;\n  \n  const club = user.clubs.find(c => c.id === clubId);\n  return club ? club.role === 'admin' || club.role === 'owner' : false;\n}\n\nexport default {\n  setToken,\n  getToken,\n  removeToken,\n  setUser,\n  getUser,\n  removeUser,\n  handleLoginSuccess,\n  logout,\n  isLoggedIn,\n  isAdmin,\n  isClubAdmin\n} "],"names":["uni"],"mappings":";;AAMA,MAAM,YAAY;AAElB,MAAM,gBAAgB;AAcf,SAAS,WAAW;AACzB,SAAOA,oBAAI,eAAe,SAAS,KAAK;AAC1C;AAaO,SAAS,QAAQ,UAAU;AAChCA,gBAAAA,MAAI,eAAe,eAAe,QAAQ;AAC5C;AAMO,SAAS,UAAU;AACxB,SAAOA,oBAAI,eAAe,aAAa,KAAK;AAC9C;AAKO,SAAS,aAAa;AAC3BA,sBAAI,kBAAkB,aAAa;AACrC;;;;;"}