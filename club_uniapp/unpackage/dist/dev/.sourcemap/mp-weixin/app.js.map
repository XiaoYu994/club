{"version":3,"file":"app.js","sources":["App.vue","main.js"],"sourcesContent":["<script>\r\nimport wsClient from '@/utils/websocket'\r\nimport apiModule from '@/api/api.js'\r\n\r\nexport default {\r\n  onLaunch: function() {\r\n    console.warn('当前组件仅支持 uni_modules 目录结构 ，请升级 HBuilderX 到 3.1.0 版本以上！')\r\n    console.log('App Launch')\r\n\r\n    // 检查是否已登录，如果已登录则建立WebSocket连接\r\n    const token = uni.getStorageSync('token')\r\n    if (token) {\r\n      console.log('【App】检测到用户已登录，建立WebSocket连接')\r\n      wsClient.connect(apiModule.baseURL || 'http://localhost:8081')\r\n    } else {\r\n      console.log('【App】用户未登录，跳过WebSocket连接')\r\n    }\r\n\r\n    // 注册全局活动取消通知处理器\r\n    wsClient.onMessageType('activity_cancel_notification', (message) => {\r\n      console.log('【全局】收到活动取消通知:', message)\r\n\r\n      // 显示通知提示\r\n      uni.showModal({\r\n        title: '活动取消通知',\r\n        content: message.message || `您报名的活动\"${message.activityTitle}\"已被取消`,\r\n        showCancel: false,\r\n        confirmText: '知道了'\r\n      })\r\n\r\n      // 触发全局事件，让活动详情页可以监听并更新\r\n      uni.$emit('activityCancelled', {\r\n        activityId: message.activityId,\r\n        activityTitle: message.activityTitle\r\n      })\r\n    })\r\n  },\r\n  onShow: function() {\r\n    // const token = uni.getStorageSync('token')\r\n    // const pages = getCurrentPages()\r\n    // const currentPage = pages.length ? pages[pages.length - 1] : null\r\n    // // 请根据你的实际登录页路径调整\r\n    // if (!token && (!currentPage || currentPage.route !== 'pages/user/login')) {\r\n    //   uni.reLaunch({ url: '/pages/user/login' })\r\n    // }\r\n\r\n  },\r\n  onHide: function() {\r\n    console.log('App Hide')\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t/*每个页面公共css */\r\n\t@import '@/uni_modules/uni-scss/index.scss';\r\n\t/* #ifndef APP-NVUE */\r\n\t@import '@/static/customicons.css';\r\n\t@import '@/common/style/common-style.scss';\r\n\r\n\t// 设置整个项目的背景色\r\n\tpage {\r\n\t\tbackground-color: #f5f5f5;\r\n\t}\r\n\r\n\t/* #endif */\r\n\t.example-info {\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #333;\r\n\t\tpadding: 10px;\r\n\t}\r\n</style>\r\n","\n// #ifndef VUE3\r\nimport Vue from 'vue'\r\nimport App from './App'\r\n\r\nVue.config.productionTip = false\r\n\r\nApp.mpType = 'app'\r\n\r\nconst app = new Vue({\r\n    ...App\r\n})\r\napp.$mount()\r\n// #endif\n\n// #ifdef VUE3\r\nimport { createSSRApp } from 'vue'\nimport App from './App.vue'\r\nimport api from './api/api.js'\nexport function createApp() {\n  const app = createSSRApp(App)\r\n  app.config.globalProperties.$api = api;\n  return {\n    app\n  }\n}\r\n// #endif"],"names":["uni","wsClient","apiModule","createSSRApp","App","api"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA,MAAK,YAAU;AAAA,EACb,UAAU,WAAW;AACnBA,kBAAAA,MAAA,MAAA,QAAA,gBAAa,uDAAuD;AACpEA,kBAAAA,MAAY,MAAA,OAAA,gBAAA,YAAY;AAGxB,UAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxC,QAAI,OAAO;AACTA,oBAAAA,oCAAY,6BAA6B;AACzCC,sBAAAA,SAAS,QAAQC,kBAAU,WAAW,uBAAuB;AAAA,WACxD;AACLF,oBAAAA,MAAY,MAAA,OAAA,iBAAA,0BAA0B;AAAA,IACxC;AAGAC,oBAAAA,SAAS,cAAc,gCAAgC,CAAC,YAAY;AAClED,oBAAAA,MAAA,MAAA,OAAA,iBAAY,iBAAiB,OAAO;AAGpCA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS,QAAQ,WAAW,UAAU,QAAQ,aAAa;AAAA,QAC3D,YAAY;AAAA,QACZ,aAAa;AAAA,OACd;AAGDA,oBAAG,MAAC,MAAM,qBAAqB;AAAA,QAC7B,YAAY,QAAQ;AAAA,QACpB,eAAe,QAAQ;AAAA,OACxB;AAAA,KACF;AAAA,EACF;AAAA,EACD,QAAQ,WAAW;AAAA,EASlB;AAAA,EACD,QAAQ,WAAW;AACjBA,kBAAAA,MAAA,MAAA,OAAA,iBAAY,UAAU;AAAA,EACxB;AACF;AC/BO,SAAS,YAAY;AAC1B,QAAM,MAAMG,cAAY,aAACC,SAAG;AAC5B,MAAI,OAAO,iBAAiB,OAAOC,QAAAA;AACnC,SAAO;AAAA,IACL;AAAA,EACD;AACH;;;"}