{"version":3,"file":"activity-card.js","sources":["components/activity-card/activity-card.vue","../../../../../Software/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovQ09ERS9jYXBzdG9uZS1wcm9qZWN0L2NsdWItbWFzdGVyL2NsdWIvY2x1Yl91bmlhcHAvY29tcG9uZW50cy9hY3Rpdml0eS1jYXJkL2FjdGl2aXR5LWNhcmQudnVl"],"sourcesContent":["<template>\r\n  <view class=\"activity-card\" @tap=\"goToActivityDetail\">\r\n    <image class=\"activity-image\" :src=\"activity.poster || '/static/images/default-club.png'\" mode=\"aspectFill\"></image>\r\n    <view class=\"activity-info\">\r\n      <view class=\"activity-title\">{{ activity.title }}</view>\r\n      <view class=\"activity-meta\">\r\n        <view class=\"meta-item\">\r\n          <uni-icons type=\"calendar\" size=\"14\" color=\"#666\"></uni-icons>\r\n          <text>{{ formatDate(activity.startTime) }}</text>\r\n        </view>\r\n        <view class=\"meta-item\">\r\n          <uni-icons type=\"location\" size=\"14\" color=\"#666\"></uni-icons>\r\n          <text>{{ activity.address || '未设置地点' }}</text>\r\n        </view>\r\n      </view>\r\n      <view class=\"activity-stats\">\r\n        <view :class=\"['activity-status', getStatusClass]\">\r\n          {{ statusText }}\r\n        </view>\r\n        <view class=\"activity-count\">\r\n          <text>{{ activity.joinCount || 0 }}人报名</text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    \r\n    <!-- 管理員操作按鈕 -->\r\n    <view v-if=\"isAdmin\" class=\"action-buttons\">\r\n      <!-- 取消活动按钮，仅报名中状态显示 -->\r\n      <view v-if=\"canCancel\" class=\"action-btn cancel\" @tap.stop=\"cancelActivity\">\r\n        <uni-icons type=\"close\" size=\"16\" color=\"#ff9800\"></uni-icons>\r\n      </view>\r\n      <view class=\"action-btn edit\" @tap.stop=\"editActivity\">\r\n        <uni-icons type=\"compose\" size=\"16\" color=\"#2979ff\"></uni-icons>\r\n      </view>\r\n      <view class=\"action-btn delete\" @tap.stop=\"deleteActivity\">\r\n        <uni-icons type=\"trash\" size=\"16\" color=\"#f44336\"></uni-icons>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { computed } from 'vue'\r\nimport { formatDate } from '@/utils/common.js'\r\n\r\n// 定義組件的屬性\r\nconst props = defineProps({\r\n  activity: {\r\n    type: Object,\r\n    required: true\r\n  },\r\n  isAdmin: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\n\r\n// 定義組件的事件\r\nconst emit = defineEmits(['detail', 'edit', 'delete', 'cancel'])\r\n\r\n// 計算活動狀態文本\r\nconst statusText = computed(() => {\r\n  const status = props.activity.status\r\n\r\n  // status=0: 已取消\r\n  if (status === 0) {\r\n    return '已取消'\r\n  }\r\n\r\n  // status=1: 计划中（待审核）\r\n  if (status === 1) {\r\n    return '计划中'\r\n  }\r\n\r\n  // status=3: 已结束\r\n  if (status === 3) {\r\n    return '已结束'\r\n  }\r\n\r\n  // status=2: 根据时间判断\r\n  const now = Date.now()\r\n  const startTime = Number(props.activity.startTime || 0)\r\n  const endTime = Number(props.activity.endTime || 0)\r\n\r\n  if (now > endTime) {\r\n    return '已结束'\r\n  } else if (now >= startTime && now <= endTime) {\r\n    return '进行中'\r\n  } else {\r\n    return '报名中'\r\n  }\r\n})\r\n\r\n// 計算活動狀態樣式類\r\nconst getStatusClass = computed(() => {\r\n  const status = props.activity.status\r\n\r\n  // status=0: 已取消\r\n  if (status === 0) {\r\n    return 'cancelled'\r\n  }\r\n\r\n  // status=1: 计划中\r\n  if (status === 1) {\r\n    return 'planned'\r\n  }\r\n\r\n  // status=3: 已结束\r\n  if (status === 3) {\r\n    return 'ended'\r\n  }\r\n\r\n  // status=2: 根据时间判断\r\n  const now = Date.now()\r\n  const startTime = Number(props.activity.startTime || 0)\r\n  const endTime = Number(props.activity.endTime || 0)\r\n\r\n  if (now > endTime) {\r\n    return 'ended'\r\n  } else if (now >= startTime && now <= endTime) {\r\n    return 'ongoing'\r\n  } else {\r\n    return 'signup'\r\n  }\r\n})\r\n\r\n// 計算是否可以取消活動（僅報名中狀態）\r\nconst canCancel = computed(() => {\r\n  const status = props.activity.status\r\n\r\n  // 只有status=2且当前时间<开始时间才能取消（即报名中状态）\r\n  if (status !== 2) {\r\n    return false\r\n  }\r\n\r\n  const now = Date.now()\r\n  const startTime = Number(props.activity.startTime || 0)\r\n\r\n  return now < startTime\r\n})\r\n\r\n// 跳轉到活動詳情\r\nconst goToActivityDetail = () => {\r\n  emit('detail', props.activity)\r\n}\r\n\r\n// 編輯活動\r\nconst editActivity = () => {\r\n  emit('edit', props.activity)\r\n}\r\n\r\n// 刪除活動\r\nconst deleteActivity = () => {\r\n  emit('delete', props.activity)\r\n}\r\n\r\n// 取消活动\r\nconst cancelActivity = () => {\r\n  emit('cancel', props.activity)\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.activity-card {\r\n  margin-bottom: 30rpx;\r\n  background: #fff;\r\n  border-radius: 18rpx;\r\n  overflow: hidden;\r\n  box-shadow: 0 2rpx 12rpx rgba(0,0,0,0.08);\r\n  display: flex;\r\n  padding: 24rpx;\r\n  position: relative;\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n  \r\n  .activity-image {\r\n    width: 180rpx;\r\n    height: 120rpx;\r\n    border-radius: 12rpx;\r\n    flex-shrink: 0;\r\n    margin-right: 24rpx;\r\n    object-fit: cover;\r\n  }\r\n  \r\n  .activity-info {\r\n    max-width: calc(100% - 204rpx);\r\n    overflow: hidden;\r\n    \r\n    .activity-title {\r\n      font-size: 30rpx;\r\n      font-weight: 600;\r\n      color: #333;\r\n      margin-bottom: 12rpx;\r\n      white-space: nowrap;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n    }\r\n    \r\n    .activity-meta {\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      margin-bottom: 16rpx;\r\n      \r\n      .meta-item {\r\n        display: flex;\r\n        align-items: center;\r\n        font-size: 24rpx;\r\n        color: #666;\r\n        margin-right: 30rpx;\r\n        margin-bottom: 8rpx;\r\n        \r\n        text {\r\n          margin-left: 8rpx;\r\n          white-space: nowrap;\r\n          overflow: hidden;\r\n          text-overflow: ellipsis;\r\n        }\r\n      }\r\n    }\r\n    \r\n    .activity-stats {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n      \r\n      .activity-status {\r\n        padding: 4rpx 16rpx;\r\n        border-radius: 20rpx;\r\n        font-size: 22rpx;\r\n\r\n        &.signup {\r\n          color: #2979ff;\r\n          background: rgba(41, 121, 255, 0.1);\r\n        }\r\n\r\n        &.ongoing {\r\n          color: #4caf50;\r\n          background: rgba(76, 175, 80, 0.1);\r\n        }\r\n\r\n        &.ended {\r\n          color: #999;\r\n          background: rgba(153, 153, 153, 0.1);\r\n        }\r\n\r\n        &.planned {\r\n          color: #ff9800;\r\n          background: rgba(255, 152, 0, 0.1);\r\n        }\r\n\r\n        &.cancelled {\r\n          color: #f44336;\r\n          background: rgba(244, 67, 54, 0.1);\r\n        }\r\n      }\r\n      \r\n      .activity-count {\r\n        font-size: 22rpx;\r\n        color: #999;\r\n      }\r\n    }\r\n  }\r\n  \r\n  .action-buttons {\r\n    position: absolute;\r\n    right: 24rpx;\r\n    top: 24rpx;\r\n    display: flex;\r\n    \r\n    .action-btn {\r\n      width: 60rpx;\r\n      height: 60rpx;\r\n      border-radius: 30rpx;\r\n      background: rgba(255, 255, 255, 0.9);\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      margin-left: 20rpx;\r\n      box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.1);\r\n\r\n      &.cancel {\r\n        border: 1rpx solid rgba(255, 152, 0, 0.3);\r\n      }\r\n\r\n      &.edit {\r\n        border: 1rpx solid rgba(41, 121, 255, 0.3);\r\n      }\r\n\r\n      &.delete {\r\n        border: 1rpx solid rgba(244, 67, 54, 0.3);\r\n      }\r\n    }\r\n  }\r\n}\r\n</style> ","import Component from 'D:/CODE/capstone-project/club-master/club/club_uniapp/components/activity-card/activity-card.vue'\nwx.createComponent(Component)"],"names":["computed"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AA8CA,UAAM,QAAQ;AAYd,UAAM,OAAO;AAGb,UAAM,aAAaA,cAAQ,SAAC,MAAM;AAChC,YAAM,SAAS,MAAM,SAAS;AAG9B,UAAI,WAAW,GAAG;AAChB,eAAO;AAAA,MACR;AAGD,UAAI,WAAW,GAAG;AAChB,eAAO;AAAA,MACR;AAGD,UAAI,WAAW,GAAG;AAChB,eAAO;AAAA,MACR;AAGD,YAAM,MAAM,KAAK,IAAK;AACtB,YAAM,YAAY,OAAO,MAAM,SAAS,aAAa,CAAC;AACtD,YAAM,UAAU,OAAO,MAAM,SAAS,WAAW,CAAC;AAElD,UAAI,MAAM,SAAS;AACjB,eAAO;AAAA,MACR,WAAU,OAAO,aAAa,OAAO,SAAS;AAC7C,eAAO;AAAA,MACX,OAAS;AACL,eAAO;AAAA,MACR;AAAA,IACH,CAAC;AAGD,UAAM,iBAAiBA,cAAQ,SAAC,MAAM;AACpC,YAAM,SAAS,MAAM,SAAS;AAG9B,UAAI,WAAW,GAAG;AAChB,eAAO;AAAA,MACR;AAGD,UAAI,WAAW,GAAG;AAChB,eAAO;AAAA,MACR;AAGD,UAAI,WAAW,GAAG;AAChB,eAAO;AAAA,MACR;AAGD,YAAM,MAAM,KAAK,IAAK;AACtB,YAAM,YAAY,OAAO,MAAM,SAAS,aAAa,CAAC;AACtD,YAAM,UAAU,OAAO,MAAM,SAAS,WAAW,CAAC;AAElD,UAAI,MAAM,SAAS;AACjB,eAAO;AAAA,MACR,WAAU,OAAO,aAAa,OAAO,SAAS;AAC7C,eAAO;AAAA,MACX,OAAS;AACL,eAAO;AAAA,MACR;AAAA,IACH,CAAC;AAGD,UAAM,YAAYA,cAAQ,SAAC,MAAM;AAC/B,YAAM,SAAS,MAAM,SAAS;AAG9B,UAAI,WAAW,GAAG;AAChB,eAAO;AAAA,MACR;AAED,YAAM,MAAM,KAAK,IAAK;AACtB,YAAM,YAAY,OAAO,MAAM,SAAS,aAAa,CAAC;AAEtD,aAAO,MAAM;AAAA,IACf,CAAC;AAGD,UAAM,qBAAqB,MAAM;AAC/B,WAAK,UAAU,MAAM,QAAQ;AAAA,IAC/B;AAGA,UAAM,eAAe,MAAM;AACzB,WAAK,QAAQ,MAAM,QAAQ;AAAA,IAC7B;AAGA,UAAM,iBAAiB,MAAM;AAC3B,WAAK,UAAU,MAAM,QAAQ;AAAA,IAC/B;AAGA,UAAM,iBAAiB,MAAM;AAC3B,WAAK,UAAU,MAAM,QAAQ;AAAA,IAC/B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9JA,GAAG,gBAAgB,SAAS;"}